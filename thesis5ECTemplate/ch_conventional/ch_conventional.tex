\chapter{振動測定系と測定信号}
\label{chap:measurementstructsig}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，本研究で扱う信号の測定条件と得られる信号について説明する．
\textcolor{red}{まず\ref{sec:conv:measurementcondition}節では，本研究で使用する観測信号の測定条件，及び観測信号から分離した心拍信号と比較する正解値として接触型ECGセンサについて説明する．
\ref{sec:conv:signal}節では，\ref{sec:conv:measurementcondition}節で述べた測定条件から得られる時間波形，及び時間波形にSTFTを適用して得られるパワースペクトログラムについて説明する．また，接触型ECGセンサから得られる信号にSTFTを適用し，観測信号のパワースペクトログラムと比較することで振動台の成分，心拍，呼吸，及び体動等のその他の成分を確認する．
\ref{sec:conv:conclusion2}では，本章のまとめを述べる．}

%----------------------------------------------
\section{測定条件}
\label{sec:conv:measurementcondition}
%----------------------------------------------
本研究で使用する信号の\textcolor{red}{振動測定系}はFig. \ref{fig:sensorstructure}に示すとおりである．\textcolor{red}{運転者を模した}被験者が座った状態で\textcolor{red}{振動測定系}全体を振動させる．Fig.~\ref{fig:sensorimg}に示されている\textcolor{red}{レーダセンサ}を，\textcolor{red}{背部と臀部にあたるシートの内部に埋め込み}，測定を行う．レーダセンサのサンプリング周波数は40~Hzである．\textcolor{red}{振動測定系の振動はsin波で単軸加振であり，Fig.~\ref{fig:sensorstructure}に示すとおり，前後・上下・左右方向に振動する．本研究で使用したデータはTable~\ref{tab:vibevacondition}に示すようにNo.~0～No.~6まである．No.~0は振動を加えずに運転者を模した被験者を観測しており，このデータのみ観測時間が5分となっている．No.~1～No.~6のデータは観測時間が7分である．観測開始から1分間は振動を加えていない状態で観測し，その後の5分間は振動を加えた状態，残りの1分間は再度，振動を加えていない状態で観測している．振動は上下方向に加えている．No.~1～No.4~の振幅値はそれぞれ，4~mm, 10~mm, 40~mm, 40~mmで周波数の値は1.2~Hz，No.~5, No.~6の振幅値はそれぞれ4~mm, 10~mmで周波数の値は2.4~Hzとなっている．また，No.~4では，振動の軽減の程度を確認するために被験者はハンドルを握りシートベルトを着用している．}

\textcolor{red}{また，本研究では，分離した信号と比較する正解値としてFig.~\ref{fig:ecgsensor}に示すBiopac社の接触型ECGセンサ，Zephr~Bioharnessを用いて心拍のリファレンスデータを取得する．接触型ECGであるため，振動台の振動が加えられても高精度な心拍値を得ることが可能である．但し，\ref{chap:intro}章で述べた通りこのセンサは接触型であるので，本研究ではこのセンサから得られる心拍値と同程度の制度をレーダセンサから得られること目的としている．接触型ECGセンサはTable~\ref{tab:ecgdata}に示すように，ECGセンサ生データ，ピエゾセンサ生データ，R-R間隔（R-R interval: RRI），心拍数，呼吸数，及び呼吸の深さを測定する．また，サンプリング周波数は250~Hzである．}


%-%-%-%-%-%-%-%-%
\begin{table}[tb]
  \caption{\textcolor{red}{Evaluation conditions using vibration measurement sysytem.}}
  \centering
  \scalebox{1.0}[1.0]{
  \begin{tabular}{|c|c|c|c|c|} \hline
    Data no.~ & Vibration direction & Amplitude~[mm] & Frequency~[Hz] &  Handle \\ \hline \hline
    0 & No vibration & - & - & - \\ \hline
    1 & \multirow{6}{*}{Up and Down} & 4 & 1.2 & - \\ \cline{1-1} \cline{3-5}
    2 & & 10 & 1.2 & - \\ \cline{1-1} \cline{3-5}
    3 & & 40 & 1.2 & - \\ \cline{1-1} \cline{3-5}
    4 & & 40 & 1.2 & Use \\ \cline{1-1} \cline{3-5}
    5 & & 4 & 2.4 & -\\ \cline{1-1} \cline{3-5}
    6 & & 10 & 2.4 & - \\ \hline
  \end{tabular}
  }
  \label{tab:vibevacondition}
\end{table}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=0.45\hsize]{./ch_conventional/fig/ecgsensor.pdf}
\caption{\textcolor{red}{Contact ECG sensor \cite{bioharness}.}}
\label{fig:ecgsensor}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{table}[tb]
  \caption{\textcolor{red}{Data of contact ECG sensor.}}
  \centering
  \scalebox{1.0}[1.0]{
  \begin{tabular}{|c|c|c|c|c|c|} \hline
    \begin{tabular}{c} 
    Raw data \\
    obtained by \\
    ECG sensor \\
    \relax [mV]
    \end{tabular} &
    \begin{tabular}{c} 
    Raw data \\
    obtained by \\
    piezo sensor \\
    \relax [mV]
    \end{tabular} &
    \begin{tabular}{c}
    RRI \\
    \relax [sec]
    \end{tabular} &
    \begin{tabular}{c}
    Heart \\
    rate \\
    \relax [bpm]
    \end{tabular} &
    \begin{tabular}{c}
    Breathing \\
    rate \\
    \relax [bpm]
    \end{tabular} &
    \begin{tabular}{c}
    Depth \\
    of \\
    breathing
    \end{tabular} \\ \hline \hline
    54.5852 & 0.0574969 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0574969 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864    \\ \hline
    \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\ \hline	
  \end{tabular}
  }
  \label{tab:ecgdata}
\end{table}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{測定で得られる信号}
\label{sec:conv:signal}
%----------------------------------------------
\ref{sec:conv:measurementcondition}節の\textcolor{red}{振動測定系}によって得られる\textcolor{red}{観測信号はFig.~\ref{fig:sensorimg}に示すように4チャネルの時間波形である．一例として，Tabel~\ref{tab:vibevacondition}に示すData no.~1の時間波形をFig.~\ref{fig:obssig}に示す．このとき，横軸及び縦軸は，それぞれ測定時間及び体表面の変位量となっている．\ref{sec:conv:measurementcondition}節で述べた通り，Fig.~\ref{fig:obssig}の60秒から360秒の間で振動が加えられているため時間波形が他の時間の時間波形とは異なっていることがわかる．振動が加えられていない時間での時間波形には，心拍，呼吸，及び，体動の信号に由来する成分が現れている．また，レーダセンサはチャネル間で近い距離にビームを当てて測定しているため，完全に一致した時間波形ではないが，チャネル間に強い相関を持っていることも確認できる．}

\textcolor{red}{また，観測信号にSTFTを適用して得られる，パワースペクトログラムをFig.~\ref{fig:4chobsspect}に示す．Fig.~\ref{fig:4chobsspect}は4チャネルのパワースペクトログラムで，カラーマップは4チャネルで共通化している．Fig.~\ref{fig:1chobsspect}はFig.~\ref{fig:4chobsspect}のCh.~1のパワースペクトログラムである．60秒から360秒までの間に約1.2~Hz，そしてその整数倍の2.4~Hz, 3.6~Hz, 4.8~Hz, 6.0~Hz, 7.2~Hzの直線の成分は振動台による振動成分である．呼吸成分が約0.3~Hzに，そして1.5~Hz, 3.2~Hz, 4.0~Hzに呼吸の高調波成分が確認できる．このように時間波形をスペクトログラムに描画することで，振動台の振動成分，心拍や呼吸由来の成分，及び体動等のその他の成分が確認できる．}

%-%-%-%-%-%-%-%-%
\begin{figure}[b]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/obsSig.pdf}
\caption{\textcolor{red}{Four-channel observed signals obtained by radar sensor.}}
\label{fig:obssig}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/obsSpect.pdf}
\caption{\textcolor{red}{Spectrograms of four-channel observed signals calculated by STFT.}}
\label{fig:4chobsspect}
\end{figure}
%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/1chobsspect.pdf}
\caption{\textcolor{red}{Each component in spectrogram of observed signal calculated by STFT.}}
\label{fig:1chobsspect}
\end{figure}
%-%-%-%-%-%-%-%

%----------------------------------------------
\section{本章のまとめ}
\label{sec:conv:conclusion2}
%----------------------------------------------
\textcolor{red}{本章では，振動測定系の測定条件と測定によって得られる時間波形について説明した．また，観測信号から心拍信号を分離した際に比較を行うために使用した接触型ECGセンサから得られる信号ついて説明し，その信号にSTFTを適用して得られたパワースペクトログラムを時間波形のパワースペクトログラムを比較し，振動台の振動成分，心拍，呼吸，及び体動等のその他の成分を確認した．
次章では，時間周波数領域のBSSの定式化を行い，Itakura--Saitoダイバージェンスに基づくNMF（NMF based on Itakura-Saito divergence: ISNMF）の説明を行う．また観測信号から心拍信号を分離するために適用するIVA, ILRMA，$t$-ILRMA，及び心拍推定アルゴリズムについて説明する．}


\chapter{適用手法}
\label{chap:methods}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，本研究で適用した手法について説明する．
まず\ref{sec:conv:researchmotivation}節では，本研究の動機について説明する．
\ref{sec:conv:bssformularization}節では，周波数領域におけるBSSの定式化を行う．
\ref{sec:conv:isnmf}節では，行列分解の手法の一つであるNMFのうちISNMFについて説明する
\ref{sec:conv:ilrma}節では，本研究で扱ったILRMA，\ref{sec:conv:tilrma}節では，本研究で扱った$t$-ILRMAについて，\ref{sec:conv:heartrateestalgo}節では，心拍推定アルゴリズムについて説明する．

%----------------------------------------------
\section{本研究の動機}
\label{sec:conv:researchmotivation}
%----------------------------------------------
\textcolor{red}{運転者の体表面とレーダセンサの相対的な位置関係は未知としたまま心拍推定を行えることが望ましい．従って，BSSと呼ばれる手法を\ref{chap:measurementstructsig}章で述べた観測信号に適用することは妥当であると考えられる．さらに，BSSはとりわけ音響信号処理分野で高度に発展してきた歴史を持つ．音響信号処理分野では残響による信号源（音源）の混合が部屋の残響などによる畳み込み混合となってしまうため，時間領域でのBSSでは音源を分離することはできない．そのため，観測信号にSTFTを適用して時間周波数領域でBSSを行う手法が長く研究されており，近年においては，IVAやILRMA等，高度に発展したアルゴリズムが提案されている．このような，本論文では前述の音響信号処理分野で高度に発展したBSSアルゴリズムをレーダセンサで観測された4チャネルの信号に適用し，心拍由来の信号，呼吸，及び体動由来の信号等の分離が可能であるか，実験的に調査する．}

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=0.75\hsize]{./ch_conventional/fig/bss.pdf}
\caption{Outline of BSS, where $N=M=2$.}
\label{fig:bss}
\end{figure}
%-%-%-%-%-%-%-%-%


%----------------------------------------------
\section{BSSの定式化}
\label{sec:conv:bssformularization}
%----------------------------------------------

\textcolor{red}{音響信号処理分野におけるBSSでは，録音時の部屋の残響や音速の遅さ等に起因して，音源の混合現象は時間領域での瞬時混合（Fig.~\ref{fig:bss}における混合行列$\bm{A}$の行列積）ではなく，畳み混み混合になる．このような複雑な混合系を持つ観測信号を単純な瞬時混合でモデル化するために，観測信号にSTFTを適用し，時価領域から時間周波数領域の信号に変換することが一般的である．時間領域での畳み込み混合は，時間周波数領域での瞬時混合とみなせるため，Fig.~\ref{fig:bss}に示すような混合系を周波数ごとに考えればよい．
このような混合系のモデル化に基づくBSSを周波数領域BSSと呼ばれ，音響信号処理においては効果的な音源分離を達成するための重要なモデルとなっている．本論文で取り扱うBSSであるIVA及びILRMAはいずれも周波数領域のBSSの一つである．}

以下に，周波数領域BSSの定式化を行う．
複数の\textcolor{red}{信号源}が混合している観測信号\textcolor{red}{において，信号源数及び観測チャネル数（センサ数）}をそれぞれ$N$及び$M$と定義する．
混合前の信号源，観測信号，及び分離信号に対して\textcolor{red}{STFTを適用したものをそれぞれ次式で定義する．}
\begin{align}
\bm{s}_{ij} &= [s_{ij1}, s_{ij2}, \cdots, s_{ijn}, \cdots, s_{ijN}]^{\mathrm{T}} \in \mathbb{C}^{N} \label{eq:s} \\
\bm{x}_{ij} &= [x_{ij1}, x_{ij2}, \cdots, x_{ijm}, \cdots, x_{ijM}]^{\mathrm{T}} \in \mathbb{C}^{M} \label{eq:x} \\
\bm{y}_{ij} &= [y_{ij1}, y_{ij2}, \cdots, y_{ijn}, \cdots, y_{ijN}]^{\mathrm{T}} \in \mathbb{C}^{N} \label{eq:y}
\end{align}
ここで，\textcolor{red}{$i=1, 2,  \cdots, I$, $j=1, 2,  \cdots, J$, $n=1, 2,  \cdots, N$, 及び$m=1, 2, \cdots, M$はそれぞれ周波数ビン，時間フレーム，信号源，及びチャネルのインデクスを表す．ここで，$^{\mathrm{T}}$は行列及びベクトルの転置を表す．また，式(\ref{eq:s})--式(\ref{eq:y})の各信号においては，時間周波数行列としての表記もそれぞれ$\bm{S}_n\in\mathbb{C}^{{I\times J}}$, $\bm{X}_m\in\mathbb{C}^{{I\times J}}$，及び$\bm{Y}_n\in\mathbb{C}^{{I\times J}}$として定義しておく．}
\textcolor{red}{式(\ref{eq:s})--式(\ref{eq:y})において}，周波数ごとの時不変な（時間フレーム$j$に依存しない）混合行列$\bm{A}_i \in \mathbb{C}^{M\times N}$を用いると，混合時の\textcolor{red}{畳み込み長}がSTFTの短時間信号長（窓長）$L$よりも十分に短い場合，観測信号は次式で表せる.
\begin{align}
  \bm{x}_{ij} = \bm{A}_i \bm{s}_{ij} \label{eq:xas}
\end{align}
ここで，$M=N$\textcolor{red}{（信号源数とチャネル数が等しい）}かつ$\bm{A}_i$がフルランクの場合は，分離行列$\bm{W}_{i} = [\bm{w}_{i1}~\bm{w}_{i2}~\cdots~ ~\bm{w}_{iN}]^{\mathrm{H}} \in \mathbb{C}^{N \times M} $が存在し，分離信号は次式で表せる．
\begin{align}
  \bm{y}_{ij} = \bm{W}_i \bm{x}_{ij} \label{eq:ywj}
\end{align}
ここで，$^{\mathrm{H}}$は行列及びベクトルのエルミート転置を表す．
\textcolor{red}{周波数領域BSSは周波数ごとの混合行列$\bm{A}_i$が未知の状態で周波数ごとの分離行列$\bm{W}_{i} \approx \bm{A}_i^{-1}$}を全ての周波数$i=1, 2, \cdots, I$において推定する問題である．


%----------------------------------------------
\section{IVA}
\label{sec:conv:iva}
%----------------------------------------------
%-%-%-%-%-%-%-%-%
\begin{figure}[t]
\centering
\includegraphics[width=0.95\hsize]{./ch_conventional/fig/iva.pdf}
\caption{Mixing and demixing models in IVA, where $N=M=2$.}
\label{fig:ivamodel}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[t]
\centering
\includegraphics[width=0.8\hsize]{./ch_conventional/fig/laplace_sav.pdf}
\caption{Zero-mean and spherically symmetric Laplace distribution, where $I=2$ and $s^*_{ijn}$ can be considered as either real or imaginary part of $s_{ijn}$.}
\label{fig:laplace}
\end{figure}
%-%-%-%-%-%-%-%-%
ここでは\textcolor{red}{本節では，音響信号処理分野で有名な周波数領域のBSSの一つであるIVAについて概説する．信号源，観測信号，及び分離信号のそれぞれについて，全ての周波数ビンに関する成分をまとめたベクトルを次のように定義する．}
\begin{align}
    \overline{\bm{s}}_{jn} &= [s_{1jn}, s_{2jn}, \cdots, s_{ijn}, \cdots, s_{Ijn} ]^{\mathrm{T}} \in \mathbb{C}^{I} \\
    \overline{\bm{x}}_{jm} &= [x_{1jm}, x_{2jm}, \cdots, x_{ijm}, \cdots, x_{Ijm} ]^{\mathrm{T}} \in \mathbb{C}^{I} \\
    \overline{\bm{y}}_{jn} &= [y_{1jn}, y_{2jn}, \cdots, y_{ijn}, \cdots, y_{Ijn} ]^{\mathrm{T}} \in \mathbb{C}^{I}
\end{align}
Fig. \ref{fig:ivamodel}に$M=N=2$の場合\textcolor{red}{におけるIVAの混合系及び分離系のモデル図を示す．}
IVAは\textcolor{red}{周波数領域BSSであるため，周波数ごとの分離行列}$\bm{W}_i$を推定する．
ただし，推定の過程\textcolor{red}{において，}全周波数を含む$I$次元\textcolor{red}{複素}分布を\textcolor{red}{$\overline{\bm{s}}_{jn}$の生成モデルと仮定されている．さらに，この}$I$次元ベクトル内には高次相関\textcolor{red}{（ベクトル内の要素の共起性）があることを仮定している．}
このIVAの生成モデルには，Fig. \ref{fig:laplace} で示すような\textcolor{red}{$I$次元球対称複素Laplace分布}が用いられ，式(\ref{eq:iva_model})で表される．
\begin{align}
  \nonumber p(\overline{\bm{s}}_{jn}) &= p(\overline{\bm{y}}_{jn}) \\
&= \frac{1}{\pi \prod_{i} \sigma_{in}} \exp \left(  - \sqrt{ \sum_i \left| \frac{y_{ijn}}{\sigma_{in}} \right|^2}  \right)
\label{eq:iva_model}    
\end{align}
ここで，$\sigma_{in}>0$はスケールパラメタである．
式(\ref{eq:iva_model})の分布は球対称性を持つため，同一ベクトル内の成分が高次相関を持つ．
したがって，IVAは同時に生起する周波数成分を一つの\textcolor{red}{信号源}としてまとめる傾向がある．\textcolor{red}{この性質は，信号源が基本周波数成分とその整数倍の周波数成分からなる場合（調波構造を持つ場合）に，それらの成分を同一の信号源の成分とみなすことに対応する．本論文で扱う信号源においては，Fig.~\ref{fig:4chobsspect}に示されるように，心拍由来の成分や振動台で加振される成分などに顕著な調波構造がみられる．そのため，IVAが仮定する周波数間の高次相関は，本論文が対象とする観測信号や信号源に対しても有効であると考えられる．}

\textcolor{red}{信号源}周波数ベクトル間の独立性$p(\overline{\bm{y}}_{j1}, \overline{\bm{y}}_{j2}, \cdots, \overline{\bm{y}}_{jN}) = \prod_n p(\overline{\bm{y}}_{in})$を仮定すると，IVAの観測信号に対する負対数尤度関数は次式で得られる．
\begin{align}
    \mathcal{L} = -2J \sum_i \log |\det \bm{W}_i| + \sum_{j,n} G(\overline{\bm{y}}_{j,n})
    \label{eq:ivalike}
\end{align}
ここで，$G(\overline{\bm{y}}_{jn})$はコントラスト関数と呼ばれ，次式で定義される．
\begin{align}
  \nonumber G(\overline{\bm{y}}_{jn}) &= -\log p(\overline{\bm{y}}_{j,n}) \\
  &= -\log \frac{1}{\pi \prod_{i} \sigma_{in}} \exp \left(  - \sqrt{ \sum_i \left| \frac{y_{ijn}}{\sigma_{in}} \right|^2}  \right)
\end{align}
IVAは, 補助関数法\cite{auxfunc}\textcolor{red}{及び反復射影法（iterative projection: IP）\cite{auxIVA}を用いた最適化アルゴリズムによって，高速かつ安定に分離行列を推定できる\cite{stable_auxIVA}．この反復最適化更新則は下記の通りである．}
\begin{align}
\bm{G}_{in} &= \frac{1}{J} \sum_j \frac{1}{\sqrt{\sum_{i} |\bm{w}_{in}^\mathrm{H}\bm{x}_{ij}|^{2}}} \bm{x}_{ij} \bm{x}_{ij}^{\mathrm{H}} \label{ep:auxIVAip1} \\
\bm{w}_{in} &\leftarrow (\bm{W}_i \bm{U}_{in})^{-1} \bm{e}_n \label{ep:auxIVAip2} \\
\bm{w}_{in} &\leftarrow \bm{w}_{in} ( \bm{w}_{in}^{\mathrm{H}} \bm{U}_{in} \bm{w}_{in} )^{-\frac{1}{2}} \label{ep:auxIVAip3}
\end{align}
\textcolor{red}{式（\ref{ep:auxIVAip1}）--（\ref{ep:auxIVAip3}）を反復計算して分離行列$\bm{W}_i$を求めることができる．なお，この反復最適化アルゴリズムは1回の更新で負対数尤度関数（\ref{eq:ivalike}）の値が減少する（または変動しない）ことが理論的に保証されている．}


%----------------------------------------------
\section{ISNMF}
\label{sec:conv:isnmf}
%----------------------------------------------

\textcolor{red}{本節では，次節で取り扱う周波数領域BSSであるILRMAを説明するために必要なNMFの理論（特にISNMFの生成モデル）について概説する．}
NMF~\cite{NMF}とは行列分解の方法の一つである．\textcolor{red}{非負行列を低ランク近似する数理アルゴリズムの一つである．特に，少数の非負の来てベクトルを教師なし学習として推定できるため，観測された非負行列に含まれる非負潜在パターンを抽出することが可能である．音響信号処理分野では，NMFに基づくBSSも数多く提案されている\cite{singlechsep, supNMF, MNMF_oz}．}

単一チャネルの\textcolor{red}{観測信号（時間波形）にSTFTを適用することで得られる複素スペクトログラムを$\bm{Z}\in\mathbb{C}^{I\times J}$とする．この$\bm{Z}$に対するパワースペクトログラムを$|\bm{Z}|^{.2}$と表記する．ここで，行列に対する$|\cdot|$及びドット付きの指数乗はそれぞれ要素毎の絶対値及び要素毎の次数場を表す．パワースペクトログラムは非負行列であるため，NMFで次式のように低ランク近似することが可能である．}

\begin{align}
    |\bm{Z}|^{.2} = \bm{TV}　\label{eq:powerspect}
\end{align}
ここで，$\bm{T} \in \mathbb{R}^{I \times K}_{\geq 0}$を基底行列，$\bm{V} \in \mathbb{R}^{K \times J}_{\geq 0}$をアクティベーション行列という．
\textcolor{red}{また，$\bm{T}$の列数及び$\bm{V}$の行数である$K$は事前に設定するパラメタであり，式（\ref{eq:powerspect}）の右辺（モデル行列$\bm{TV}$）のランクに対応する．}通常は$K \ll \min (I,J)$となるように設定される．
\textcolor{red}{一例として，音響信号のパワースペクトログラムを$K=2$のNMFで低ランク近似した様子をFig. \ref{fig:nmf_ps}に示す．このような場合，パワースペクトログラム中に頻繁に出現するスペクトルパターンが2本の基底ベクトル（基底行列$\bm{T}$の列ベクトル）として抽出され，またそれらの時間的な強度変化がアクティベーションベクトル（アクティベーション行列の行ベクトル）に現れる．}

\textcolor{red}{ISNMFでは，}基底行列$\bm{T}$とアクティベーション行列$\bm{V}$は次式の最小化問題の解として推定される．

\begin{align}
    \nonumber \min_{\bm{T,V}} \mathcal{D}(|\bm{Z}|^{.2} | \bm{TV}) ~~\mathrm{s.t.} ~ t_{ik}, v_{kj} \geq 0 ~~\forall i,~j,~k
\end{align}
\begin{align}
    \mathcal{D}(|\bm{Z}|^{.2}|\bm{TV}) = \sum_{i,j}\left[ \frac{ |z_{ij}|^2 }{ \sum_{k}t_{ik}v_{kj} } - \log{\frac{ |z_{ij}|^2 }{ \sum_{k}t_{ik}v_{kj}}} -1 \right] \label{eq:matrixisdiv}
\end{align}
ここで，\textcolor{red}{$z_{ij}$，$t_{ik}$，及び$v_{kj}$はそれぞれ$\bm{Z}$, $\bm{T}$, 及び$\bm{V}$}の要素である．
また，\textcolor{red}{$k= 1, 1, \cdots, K$は基底ベクトルのインデクスを表す．さらに，式（\ref{eq:matrixisdiv}）}は2つの行列（$|\bm{Z}|^{.2}$及び$\bm{TV}$）間の類似度を測る関数で\textcolor{red}{あり，Itakura--Saitoダイバージェンスと呼ばれる．}ISNMFの$\bm{T}$及び$\bm{V}$の最適化のための反復更新式は式(\ref{eq:MUT})及び式(\ref{eq:MUV})で表される\cite{MU}．

\begin{align}
    t_{ik} \leftarrow t_{ik} \sqrt \frac{ \sum_j |z_{ij}|^2 v_{kj} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-2} }{ \sum_j v_{kj} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-1} } \label{eq:MUT} \\
    v_{kj} \leftarrow v_{kj} \sqrt \frac{ \sum_i |z_{ij}|^2 t_{ik} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-2} }{ \sum_i t_{ik} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-1} } \label{eq:MUV}
\end{align}
この更新式は乗算型反復更新式と呼ばれ，目的関数が単調非増加\textcolor{red}{となる}ことが保証されている．

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=0.95\hsize]{./ch_conventional/fig/NMF_ps.pdf}
\caption{NMF decomposition of power spectrogram of ordio signal, where $K=2$.}
\label{fig:nmf_ps}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[!b]
\centering
\includegraphics[width=0.8\hsize]{./ch_conventional/fig/gauss_sav.pdf}
\caption{Circularly symmetric complex Gaussian distribution.}
\label{fig:gauss}
\end{figure}
%-%-%-%-%-%-%-%-%

\textcolor{red}{ISNMFは，複素スペクトログラムに対する生成モデルを仮定した最尤推定問題と等価である．次節で述べるBSSアルゴリズムのILRMAの説明には，ISNMFの生成モデルが必要であるため，本節で述べる．}
\textcolor{red}{複素スペクトログラムである$\bm{Z}$の要素である$z_{ij}$が，次式のように複素部分成分$c_{ijk}$に分解されることを仮定する．}確率モデルに従って生成されていると仮定する．
\begin{align}
    z_{ij} = \sum_k c_{ijk}　\label{eq:zijmodel}
\end{align}
\textcolor{red}{このとき，複素部分成分$c_{ijk}$に対して次式の生成モデルを仮定する．}
\begin{align}
    c_{ij,k} \sim \mathcal{N}_{\mathbb{C}} (c_{ijk}; 0, t_{ik}v_{kj})
\end{align}
ここで，$c_{ijk}\in \mathbb{C}$は全ての$i$，$j$, 及び$k$に関して互いに独立と仮定する．
また，$c$を複素数の確率変数としたとき，\textcolor{red}{$\mathcal{N}_{\mathbb{C}} (c; \mu, \sigma^2)$は原点対称複素Gauss分布を表し，その確率密度関数は次式で与えられる．}
\begin{align}
    \mathcal{N}_{\mathbb{C}} (c; \mu, \sigma^2) &= \frac{1}{\pi \sigma^2} \exp \left( -\frac{|c-\mu|^2}{\sigma^2} \right) \label{eq:compGausiandist}
\end{align}
ここで，$\mu$及び$\sigma^2$はそれぞれ平均及び分散を示す．\textcolor{red}{この分布の外形をFig. \ref{fig:gauss}に示す．式（\ref{eq:compGausiandist}）は再生性を持つ分布であるため，式（\ref{eq:zijmodel}）で構成される$z_{ij}$もまた次式の生成モデルを持つことになる．}
\begin{align}
    z_{ij} \sim \mathcal{N}_{\mathbb{C}}\left( z_{ij}; 0, \sum_k t_{ik} v_{kj} \right) \label{eq:nmfgen}
\end{align}
\textcolor{red}{ISNMFでは}，観測信号$z_{ij}$が与えられた場合における$t_{ik}$及び$v_{kj}$の最尤推定問題を考える．
このとき，尤度関数は
\begin{align}
    \mathcal{L}(\bm{T}, \bm{V}) = \prod_{i,j} \frac{1}{\pi \sum_k t_{ik} v_{kj} } \exp \left( -\frac{|z_{ij}|^2}{\sum_k t_{ik} v_{kj}} \right)
\end{align}
となり，負対数尤度\textcolor{red}{関数}は
\begin{align}
    -\log\mathcal{L}(\bm{T}, \bm{V}) = \sum_{i,j} \left( \frac{|z_{ij}|^2}{\sum_k t_{ik} v_{kj}} + \log \sum_k t_{ik} v_{kj} + \log \pi \right) \label{eq:negativeloglikelihood}
\end{align}
で表される．
\textcolor{red}{式（\ref{eq:negativeloglikelihood}）は，パワースペクトログラム$|Z_{ij}|^2$に対するISNMFの目的関数（式（\ref{eq:matrixisdiv}））と定数部分の違いを除いて一致する．そのため，負対数尤度関数は以下のように書き換えられる．}
\begin{align}
    -\log\mathcal{L}(\bm{T}, \bm{V}) = \mathcal{D} \left( |Z|^{.2} | \bm{TV} \right) + \mathrm{const.}
    \label{eq:isnmf}
\end{align}
\textcolor{red}{この事実はパワースペクトログラム$|\bm{Z}|^{.2}$にISNMFを適用することが，式(\ref{eq:nmfgen})の生成モデルを仮定した分散の最尤推定問題と等価であることを示している．}

%----------------------------------------------
\section{ILRMA}
\label{sec:conv:ilrma}
%----------------------------------------------

\textcolor{red}{IVAよりも高精度なBSSを達成できるアルゴリズムとしてILRMA[]が提案されている．本論文においても，ILRMAに基づく心拍信号のBSSを検討するため，本節ではILRMAの生成モデル及び反復更新式について概説する．}

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=0.95\hsize]{./ch_conventional/fig/ilrmaoutline.pdf}
\caption{Parameter updates of ILRMA.}
\label{fig:ilrma_outline}
\end{figure}
%-%-%-%-%-%-%-%-%

ILRMAの反復最適化の概要をFig. \ref{fig:ilrma_outline}に示す．
\textcolor{red}｛図中の｝$\bm{T}_n\in\mathbb{R}_{\geq 0}^{I\times K}$及び$\bm{V}_n\in\mathbb{R}_{\geq 0}^{K\times J}$は，$n$番目の\textcolor{red}{信号源}のパワースペクトログラム\textcolor{red}{$|\bm{Y}_n|^{.2}$をISNMFで低ランク近似したモデル$\bm{T}_n\bm{V}_n$の基底行列及びアクティベーション行列である．}
ILRMAは, IVAに\textcolor{red}{基づく}分離行列$\bm{W}_i$の反復最適化とISNMF\textcolor{red}{による分離信号源$|\bm{Y}_n|^{.2}$の}低ランクモデリングに対応する$\bm{T}_n\bm{V}_n$の反復最適化が交互に行われる．
具体的には，分離行列$\bm{W}_i$により推定された分離信号\textcolor{red}{$|\bm{Y}_n|^{.2}$}をISNMF\textcolor{red}{で非負低ランク行列としてモデル化し}，得られた$\bm{T}_n$及び$\bm{V}_n$の各時間周波数成分を式(\ref{eq:nmfgen})における分散（各音源の生成モデルの推定パラメタ）に用いて分離行列\textcolor{red}{$\bm{W}_i$}を再度推定する，というプロセスが反復的に行われる．

ILRMAの生成モデルはISNMFと同様に次式の複素ガウス分布\textcolor{red}{が仮定されている．}
\begin{align}
    y_{ijn} &= \sum_k c_{ijnk} \\
    c_{ijnk} &= \mathcal{N}_{\mathbb{C}}(c_{ijnk}; 0, t_{ikn} v_{kjn}) \label{eq:ilrma_gen}
\end{align}
\textcolor{red}{ここで，$t_{ikn}$及び$v_{kjn}$は$\bm{T}_n$及び$\bm{V}_n$の要素である．}
また，$c_{ijnk} \in \mathbb{C}$は\textcolor{red}{$i, j, k, $及び$n$に関して}互いに独立であると仮定する．
このとき，観測\textcolor{red}{信号$(\bm{X}_n)_{n=1}^N$}が与えられた場合において, $\bm{W}_i$，$\bm{T}_n$, 及び$\bm{V}_n$を最尤推定する問題を考える．
ISNMFの\textcolor{red}{生成モデルより，}
\begin{align}
    y_{ijn} \sim \mathcal{N}_{\mathbb{C}}\left(y_{ijn};  0, \sum_k t_{ikn} v_{kjn} \right) 
\end{align}
が成り立つので，\textcolor{red}{全分離信号の結合分布は次式で表される．}
\textcolor{red}{
\begin{align}
    \nonumber p(\bm{Y}_1, \bm{Y}_2, \cdots, \bm{Y}_N) &= \prod_n p(\bm{Y}_n) \\
\nonumber &= \prod_{n, i, j} p(y_{ijn}) \\
\nonumber &= \prod_{n, i, j} \mathcal{N}_{\mathbb{C}} \left(y_{ijn}; 0, \sum_k t_{ikn}v_{kjn} \right) \\
&= \prod_{n, i, j} \frac{1}{\pi \sum_k t_{ikn}v_{kjn}} \exp \left( -\frac{|y_{ijn}|^2}{\sum_k t_{ikn}v_{kjn}} \right) \label{eq:combineddist}
\end{align}}
\textcolor{red}{式（\ref{eq:combineddist}）を用いて観測信号の負対数尤度関数を求めると次式となる．}
\textcolor{red}{
\begin{align}
　　\nonumber \mathcal{L}(\mathsf{W, T, V}) &= - \log p(\bm{X}_1, \bm{X}_2, \cdots, \bm{X}_M) \\
    \nonumber &= -\log \left[p(\bm{Y}_1, \bm{Y}_2, \cdots, \bm{Y}_N) \cdot \prod_{i, j} |\det \bm{W}_i|^2\right] \\
    \nonumber &= -\log \left \{ \left[\prod_n p(\bm{Y}_n) \right] \cdot \prod_{i, j} |\det \bm{W}_i|^2\right \} \\
    \nonumber &= \mathrm{const.}- 2J \sum_{i}  \log |\det \bm{W}_i| +\sum_{i,j,n} \left( \frac{|y_{ij}|^2}{\sum_k t_{ikn} v_{kjn}} + \log \sum_k t_{ikn} v_{kjn}\right) \\
    &= -2J \sum_i \log | \det \bm{W}_i | + \sum_{i,j,n} \left( \frac{|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}{\sum_k t_{ikn}v_{kjn}} + \log \sum_k t_{ikn}v_{kjn} \right)
    \label{eq:ilrmalike2}
\end{align}}
ここで，$\mathsf{W}=\{ \bm{W}_i \}_{i=1}^I$，$\mathsf{T}=\{ \bm{T}_n \}_{n=1}^N$, 及び$\mathsf{V}=\{ \bm{V}_n \}_{n=1}^N$は最適化パラメタの集合である．

\textcolor{red}{式（\ref{eq:ilrmalike2}）を最小化するパラメタは，以下に示す反復最適化アルゴリズムで推定される．まず}
式(\ref{eq:ilrmalike2})を見ると，第二項と第三項は式(\ref{eq:negativeloglikelihood})のISNMFの尤度関数\textcolor{red}{等価であることがわかる．}

分離行列$\bm{W}_i$に関する最適化は，分離ベクトル$\bm{w}_{in}$をIP\cite{auxIVA}ｓｗ更新することで\textcolor{red}{達成される．}
\begin{align}
\bm{U}_{in} &= \frac{1}{J} \sum_j \frac{1}{\sum_{l}t_{ikn}v_{kjn}} \bm{x}_{ij} \bm{x}_{ij}^{\mathrm{H}} \label{eq:ip1} \\
\bm{w}_{in} &\leftarrow (\bm{W}_i \bm{U}_{in})^{-1} \bm{e}_n \label{eq:ip2} \\
\bm{w}_{in} &\leftarrow \bm{w}_{in} ( \bm{w}_{in}^{\mathrm{H}} \bm{U}_{in} \bm{w}_{in} )^{-\frac{1}{2}} \label{eq:ip3}
\end{align}

\textcolor{red}{これらの更新式も, IVAやISNMFと同様に，目的関数（\ref{eq:ilrmalike2}）の値が単調非増加となることが保証されている．}


%----------------------------------------------
\section{$t$-ILRMA}
\label{sec:conv:tilrma}
%----------------------------------------------

\textcolor{red}{近年，ISNMFの複素GAuss分布に基づくに基づく生成モデルを，一般化下NMFが数多く提案されている．例えば，複素一般化Gauss分布に基づくNMF~\cite{GDD}や複素Student's $t$分布に基づくNMF（$t$-NMF）\cite{tnmf}等が提案されており，NMFに基づく特定のタスク（BSSやスパースノイズ除去等）においてISNMFよりも性能が向上することが報告されている．このことに鑑み，}複素Student's~$t$分布を生成モデル\textcolor{red}{と仮定するILRMA（$t$-ILRMA）が提案された\cite{tdist1, tdist2}．}
複素Student's~$t$分布には形状パラメタ$\nu\textgreater0$があ\textcolor{red}{る．$\nu=1$とすると複素Cauchy分布に一致し，$\nu\rightarrow2$とすると複素Gauss分布に一致する．}

$t$-ILRMAの生成モデルは次式で表される．
\textcolor{red}{
\begin{align}
     \prod_{i,j}\left(\bm{Y}_{n}\right)= \prod_{i,j}\frac{1}{\pi \sigma_{ijn}^{2} } \left( 1+\frac{2}{\nu}\frac{|y_{ijn}|^2}{\sigma_{ijn}^{2}} \right)^{\frac{2+\nu}{2}}　\label{eq:tmodel}
\end{align}
\begin{align}
     \sigma_{ijn}^{p}=\left(\sum_{k}t_{ikn}v_{kjn}\right)^{p} \label{eq:tsigma}
\end{align}}

ここで，\textcolor{red}{$\sigma_{ijn}$は時間周波数ごとに変動する非負パラメタであり，分離信号$\bm{Y}_{n}$の振幅スペクトログラム$|\bm{Y}_{n}|$のNMFモデルである．また，}$p$はNMFモデルの\textcolor{red}{信号領域]を決定する量であり}，$p=1$のときは振幅ドメイン，$p=2$のときはパワードメインを\textcolor{red}{モデル化することに}相当する．\textcolor{red}{従って}$p=2$\textcolor{red}{かつ}$\nu\rightarrow\infty$のときは，\textcolor{red}{式（\ref{eq:tmodel}）は}ISNMFの\textcolor{red}{生成}モデルに一致\textcolor{red}{する．}この\textcolor{red}{生成モデルの負対数尤度関数が$t$-ILRMAの目的関数であり，次式で与えられる．}
\textcolor{red}{
\begin{align}
    \nonumber \mathcal{L}_{t}(\mathsf{W, T, V}) =& \mathrm{const.}-2J \sum_{i}\log|\mathrm{det}\bm{W}_{i}| \\
&+\sum_{i,j}\left\lbrack\left(1+\frac{\nu}{2}\right)\log\left(1+\frac{2}{\nu}\frac{|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}{\left(\sum_{k}t_{ikn}v_{kjn}\right)^2}\right)+2\log\left(\sum_{k}t_{ikn}v_{kjn}\right)\right\rbrack \label{eq:tcost}
\end{align}}

式（\ref{eq:tcost}）を最小化するNMFの最適化パラメタ$\bm{T}_{n}, \bm{V}_{n}$の更新式は次式で表される．
\textcolor{red}{
\begin{align}
    t_{ikn}\leftarrow t_{ikn}\left\lbrack\frac{\sum_{j}\frac{|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}{\frac{\nu}{\nu+2}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{2}+\frac{2}{\nu+2}|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{-p}v_{kjn}^{-\frac{2}{p}}}{\sum_{i}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{-p}v_{kjn}}\right\rbrack^{\frac{p}{p+2}} \label{eq:tt}
\end{align}
\begin{align}
    v_{lj,n}\leftarrow v_{lj,n}\left\lbrack\frac{\sum_{i}\frac{|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}{\frac{\nu}{\nu+2}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{2}+\frac{2}{\nu+2}|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{-p}t_{il,n}^{-\frac{2}{p}}}{\sum_{i}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{-p}t_{il,n}}\right\rbrack^{\frac{p}{p+2}} \label{eq:tv}
\end{align}}

\textcolor{red}{一方}分離行列$\bm{W}_{i}$は節\ref{sec:conv:ilrma}と同様に分離ベクトル$\bm{w}_{in}$の更新をIPを用いることで次式で行われる．
\begin{align}
    \bm{U}_{in}=\frac{1}{J}\left(\frac{2}{\nu}+1\right)\sum_{j}\frac{1}{\alpha_{ijn}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{2}}\bm{x}_{ij}\bm{x}_{ij}^{\mathrm{H}} \label{eq:tip1}
\end{align}
\begin{align}
    \bm{w}_{in}\leftarrow\left(\bm{W}_{i}\bm{U}_{in}\right)^{-1}\bm{e}_{n} \label{eq:tip2}
\end{align}
\begin{align}
    \bm{w}_{in}\leftarrow\frac{\bm{w}_{in}}{\sqrt{\bm{w}_{in}^{\mathrm{H}}\bm{U}_{in}\bm{w}_{in}}} \label{eq:tip3}
\end{align}
\textcolor{red}{ここで，$¥aloha_{ijn}>0$は補助変数である．}

これらの更新式も，\textcolor{red}{IVA, ISNMF, 及びILRMAと同様に，目的関数}(\ref{eq:tcost})の値が単調非増加となることが保証されている．


%----------------------------------------------
\section{心拍推定アルゴリズム}
\label{sec:conv:heartrateestalgo}
%----------------------------------------------

\textcolor{red}{本節では，レーダセンサの観測信号やBSSで推定された心拍信号等に対して適用する心拍推定アルゴリズムについて説明する．なお，本節では単一チャネルの時間信号を処理の対象としている．この時間信号を}$\left(x[l]\right)_{l=1}^{L}$とする．ここで，$l=1, 2, \cdots , L$は離散時間インデクスであり，$L$は\textcolor{red}{信号の}時間長である．\textcolor{red}{本論文で使用する心拍推定アルゴリズムを下記に順を追って示す．}

\textcolor{red}{まず，信号の調波構造を強調しつつ低周波成分を除去するため，次式の二階微分フィルタを信号に適用する．}
\begin{equation} 
    \begin{cases}
        \begin{split}
        & x'[l]=x[l+1]-x[l] \\
        & x''[l]=x'[l+1]-x'[l]
        \end{split}                         &   \forall{l}
    \end{cases}
\end{equation}

\textcolor{red}{次に，もう一度調波構造を強調する目的で，信号に半波整流を適用する．}
\begin{equation} 
x_{\mathrm{r}}[l] =
    \begin{cases}
        \begin{split}
        & x''[l]\quad \mathrm{if}\quad x''[l]\geqq0 \\
        & 0\hspace{25pt} \mathrm{otherwise}
        \end{split}                         &   \forall{l}
    \end{cases}
\end{equation}
\textcolor{red}{さらに，心拍信号が多く存在する帯域である.7--1.4~Hzを通過域とする次楕円IIRバンドパスディジタルフィルタを適用する．この処理を次式で表す．}
\begin{align}
    \left(x_{\mathrm{BPF}}[l]\right)_{l=1}^{L}=\mathrm{BPF}\left[\left(x_{\mathrm{r}}\right)_{l=1}^{L}\right]
\end{align} \label{eq:bpf}

\textcolor{red}{最後に}，$\left(x_{\mathrm{BPF}}[l]\right)_{l=1}^{L}$\textcolor{red}{にSTFTを適用してスペクトログラムに変換し，振幅スペクトログラムの最大ピークとなる周波数を時間フレーム毎に求めることで，推定心拍を得る．}

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
本章では，周波数領域SSの定式化を行い，その代表的な手法，そしてILRMAで導入された手法について説明した．また，複素Student's $t$分布を生成モデルに持つようなILRMAである$t$-ILRMAについて説明した．心拍推定値を算出する心拍推定アルゴリズムについても説明した．次章では，\ref{chap:measurementstructsig}節で得られた測定信号に，\ref{sec:conv:iva}節で説明したIVAを適用した結果について実験を行う．

\chapter{観測信号にフィルタを適用しない場合のBSS及び心拍推定実験}
\label{chap:bsshrexp}

%----------------------------------------------
\section{まえがき}
%------------------------------------------
本章では，測定信号に対して，\ref{sec:conv:iva}節IVAを適用した結果をスペクトログラムに描画し，心拍推定アルゴリズムによって心拍推定結果を比較した結果を説明する．
心拍推定の比較には接触型ECGセンサの測定値を使用している．
まず\ref{sec:conv:expcondition4}節では，IVAを適用させる際のパラメタについて述べる．
\ref{sec:conv:expresult4}節では，IVAを適用させて得られたスペクトログラムと心拍推定グラフについての解説を述べる．

%----------------------------------------------
\section{実験条件}
\label{sec:conv:expcondition4}
%----------------------------------------------
STFTの窓長を確定するために一つの測定信号に対し4パターンの窓長に変更しIVAを適用した．実験条件はTable\ref{tab:iva}に示す．
%-%-%-%-%-%-%-%-%
\begin{table}[t]
  \caption{Experimental conditions of IVA}
  \centering
  \begin{tabular}{cc} \hline
    Parameter & Value \\ \hline \hline
    FFT length & 32, 64, 96, 128 samples  \\ \hline
    Shift length & FFt length/16 samples \\ \hline
    Channel number（Channel number: $N$） & 4 \\ \hline
    frequency bins（frequency bins: $I$） & 17, 33, 49, 65 \\ \hline
    Initial value of separating matrix & $N \times N \times I$ identity matrix  \\ \hline
    Initial value per frequency & $N \times N$ identity matrix  \\ \hline
    Number of iterations & 100\\ \hline
  \end{tabular}
  \label{tab:iva}
\end{table}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{実験結果}
\label{sec:conv:expresult4}
%----------------------------------------------
Fig. \ref{fig:siva32obs}は観測信号Back no.~2のスペクトログラムである．Fig. \ref{fig:siva32est} $\sim$ Fig. \ref{fig:siva128est}はIVAを適用した観測信号のスペクトログラムで，FFTサイズを32$\sim$128に変更したものである．Fig. \ref{fig:hrivach}は心拍推定アルゴリズムによって推定された心拍値でチャネルごとの推定結果を比較している．Fig. \ref{fig:hva32ch3}がリファレンスの心拍値を最もとらえていることがわかる．その他のデータからも同様のことがいえるため，以後の実験結果は，チャネル3について述べる．Fig. \ref{fig:hrivafftsize}はFFTサイズを変更させて心拍推定値の比較を行っているものである．$\mathrm{FFT~size}=32,~64$の場合，リファレンスの心拍値をとらえていることがわかる．その他のデータも同様の比較を行った結果，$\mathrm{FFT~size}=64$の場合，リファレンスの心拍値を最もとらえられていたため，以後の実験結果は，$\mathrm{FFT~size}=64$について述べる．

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_32_obs.pdf}
\caption{Observation back signal no.~2.}
\label{fig:siva32obs}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_32_est.pdf}
\caption{Estimated back signal no.~2, where FFT size is set to 32.}
\label{fig:siva32est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_64_est.pdf}
\caption{Estimated back signal no.~2, where FFT size is set to 64.}
\label{fig:siva64est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_96_est.pdf}
\caption{Estimated back signal no.~2, where FFT size is set to 96.}
\label{fig:siva96est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_128_est.pdf}
\caption{Estimated back signal no.~2, where FFT size is set to 128.}
\label{fig:siva128est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[htbp]
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_32_ch1.pdf}
        \subcaption{Ch1}
        \label{fig:hva32ch1}
      \end{minipage} 
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_32_ch2.pdf}
        \subcaption{Ch2}
        \label{fig:hva32ch2}
      \end{minipage} \\
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_32_ch3.pdf}
        \subcaption{Ch3}
        \label{fig:hva32ch3}
      \end{minipage} 
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_32_ch4.pdf}
        \subcaption{Ch4}
        \label{fig:hva32ch4}
      \end{minipage} 
     \caption{Estimated (red) and reference (blue) heart rates of back signal no.~2 obtained by IVA.}
     \label{fig:hrivach}
  \end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[htbp]
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_32_ch3.pdf}
        \subcaption{FFT size is set to 32}
        \label{fig:hva32ch3}
      \end{minipage} 
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_64_ch3.pdf}
        \subcaption{FFT size is set to 64}
        \label{fig:hva64ch3}
      \end{minipage} \\
   
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_96_ch3.pdf}
        \subcaption{FFT size is set to 96}
        \label{fig:hva96ch3}
      \end{minipage} 
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_128_ch3.pdf}
        \subcaption{FFT size is set to 128}
        \label{fig:hva128ch3}
      \end{minipage} 
     \caption{Estimated (red) and reference (blue) heart rates of back channel 3 signal no.~2 obtained by IVA.}
     \label{fig:hrivafftsize}
  \end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
本章では，測定信号に対してIVAを適用した，心拍推定グラフを得た．まず，4チャネルある信号のうち最も分離されているチャネルを確認した．そして，FFTサイズを変更しIVAを適用することで，最も分離制度の高い心拍推定値を得られるFFTサイズを確認した．次章では，スペクトログラムの約0.3Hzに確認できる呼吸をカットするようなフィルタを設計する．また，前処理を施した測定信号に\ref{chap:methods}章で述べた各手法を適用した結果について述べる．


\chapter{観測信号にフィルタを適用した場合のBSS及び心拍推定実験}
\label{chap:fbsshrexp}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，測定信号に対して，フィルタをかけたIVA，基底数固定型ILRMA，基底数可変型ILRMA，$t$-ILRMAを適用した結果をスペクトログラムに描画し，心拍推定アルゴリズムによって心拍推定結果を比較した結果を説明する．
心拍推定の比較には接触型ECGセンサの測定値を使用している．
まず\ref{sec:conv:motivation}節では，\ref{chap:bsshrexp}章で得られた結果からフィルタリングを行った動機について述べる．
\ref{sec:conv:filteroutline}節では，測定信号にかけるフィルタの設計について述べる．
\ref{sec:conv:expcond5}節では，IVA,基底数固定型ILRMA，基底数可変型ILRMA，$t$-ILRMAを適用させる際のパラメタについて述べる．

%----------------------------------------------
\section{動機}
\label{sec:conv:motivation}
%----------------------------------------------
Fig. \ref{fig:siva32obs} $\sim$ Fig. \ref{fig:siva128est}から約0.3Hzに確認できる呼吸が心拍推定値に影響を及ぼしていると考えたため，次節で述べるようなフィルタを前処理として測定信号に適用した．次節で適用したフィルタについて述べる．

%----------------------------------------------
\section{設計したフィルタ}
\label{sec:conv:filteroutline}
%----------------------------------------------
本研究では，等リップルハイパスFIRディジタルフィルタを用いた．カットオフ周波数は1.5Hz及びフィルタ次数は170としている．このフィルタの振幅応答と位相応答をFig.\ref{fig:ampres}とFig.\ref{fig:phaseres}に示す．

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/ampprop.pdf}
\caption{Amplitude responses.}
\label{fig:ampres}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/phaseprop.pdf}
\caption{Phase responses.}
\label{fig:phaseres}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{実験条件}
\label{sec:conv:expcond5}
%----------------------------------------------

基底数固定型ILRMAは反復毎にプロジェクションバックで正規化し，反復毎にプロジェクションバックで正規化しない．基底数固定型ILRMA，基底数可変型ILRMA及び$t$-ILRMAの実験条件はそれぞれ表(\ref{tab:fixedilrma})，表（\ref{tab:variableilrma}）及び表（\ref{tab:tilrma}）に示す．
%-%-%-%-%-%-%-%-%
\begin{table}[t]
  \caption{Experimental conditions of ILRMA without partitioning function}
  \centering
  \begin{tabular}{cc} \hline
    Parameter & Value \\ \hline \hline
    FFT length & 64 samples  \\ \hline
    Shift length & 4 samples \\ \hline
    Channel number（Channel number: $N$） & 4 \\ \hline
    frequency bins（frequency bins: $I$） & 33 \\ \hline
    Initial value of separating matrix & $N \times N \times I$ identity matrix  \\ \hline
    Initial value per frequency & $N \times N$ identity matrix  \\ \hline
    Number of iterations & 100\\ \hline
    Basis number & 3 \\ \hline \hline
  \end{tabular}
  \label{tab:fixedilrma}
\end{table}
%-%-%-%-%-%-%-%-%
%-%-%-%-%-%-%-%-%
\begin{table}[t]
  \caption{Experimental conditions of ILRMA with partitioning function}
  \centering
  \begin{tabular}{cc} \hline
    Parameter & Value \\ \hline \hline
    FFT length & 64 samples  \\ \hline
    Shift length & 4 samples \\ \hline
    Channel number（Channel number: $N$） & 4 \\ \hline
    frequency bins（frequency bins: $I$） & 33 \\ \hline 
    Initial value of separating matrix & $N \times N \times I$ identity matrix  \\ \hline
    Initial value per frequency & $N \times N$ identity matrix  \\ \hline
    Number of iterations & 100\\ \hline
    Basis number（Basis number: $K$） & 12 \\ \hline
    Basis matrix（Basis matrix: $T$） & Uniform random values $(0,1)$ \\ \hline
    Activation matrix（Activartion matrix: $V$） & Uniform random values $(0,1)$ \\ \hline 
    Partition function matrix（Partition function matrix: $Z$） & Uniform random values $(0,1)$ \\ \hline \hline
  \end{tabular}
  \label{tab:variableilrma}
\end{table}
%-%-%-%-%-%-%-%-%
%-%-%-%-%-%-%-%-%
\begin{table}[t] 
  \caption{Experimental conditions of $t$-ILRMA}
  \centering
  \begin{tabular}{cc}\hline
    Parameter & Value \\ \hline \hline
    FFT length & 64 samples  \\ \hline
    Shift length & 4 samples \\ \hline
    Channel number（Channel number: $N$） & 4 \\ \hline
    frequency bins（frequency bins: $I$） & 33 \\ \hline
    Initial value of separating matrix & $N \times N \times I$ identity matrix  \\ \hline
    Initial value per frequency & $N \times N$ identity matrix  \\ \hline
    Number of iterations & 100\\ \hline
    Freedom of student's $t$-distribution & 1, 2, 5\\ \hline
    Domains in low-rank modeling of signal source & 1(Amplitude domain), 2(Power dmain)\\ \hline
  \end{tabular}
  \label{tab:tilrma}
\end{table}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{実験結果}
\label{sec:conv:expresult5}
%----------------------------------------------

%----------------------------------------------
\subsection{IVAを適用した結果}
\label{sec:conv:resultiva}
%----------------------------------------------
Fig. \ref{fig:sfiva64obs}は\ref{sec:conv:filteroutline}節のフィルタを前処理として適用した測定信号である．Fig. \ref{fig:sfiva64est}はFig. \ref{fig:sfiva64obs}にIVAを適用した結果である．Fig. \ref{fig:hriva64ch3}はフィルタリングしていない推定信号に対して心拍推定アルゴリズムを適用した推定心拍値である．Fig. \ref{fig:fhriva64ch3}はフィルタリングした推定信号に対して心拍推定アルゴリズムを適用した結果である．Fig. \ref{fig:fhriva64ch3}はよりリファレンスデータの推定心拍値に近い値を示していることが分かる．そのためフィルタリングを行うことで推定精度が向上するといえる．しかし，振動の開始時からの約2分間と終了時は体動が大きくなることから，推定心拍値がレファレンスデータに対して大きな差が表れている．

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_filter_64_obs.pdf}
\caption{Observated back signal no.~2 with filter.}
\label{fig:sfiva64obs}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_filter_64_est.pdf}
\caption{Estimated back signal no~2 with filter}
\label{fig:sfiva64est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[htbp]
 \begin{minipage}{0.5\hsize}
  \begin{center}
   \includegraphics[width=70mm]{./ch_conventional/hrfig/hr_iva_64_ch3.pdf}
  \end{center}
  \caption{Estimated heart rate obtained by IVA.}
  \label{fig:hriva64ch3}
 \end{minipage}
 \begin{minipage}{0.5\hsize}
  \begin{center}
   \includegraphics[width=70mm]{./ch_conventional/hrfig/hr_iva_filter_64_ch3.pdf}
  \end{center}
  \caption{Estimated heart rate obtained by IVA with filter.}
  \label{fig:fhriva64ch3}
 \end{minipage}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\subsection{基底数固定型ILRMAを適用した結果}
\label{sec:conv:resultilrma1}
%----------------------------------------------
Fig. \ref{fig:silrma1}は基底数固定型ILRMAを適用した推定信号である．チャネル3のスペクトログラムに心拍成分が多く分離されているが，振動開始時と終了時の振動成分が強力であるため，分離しきれず残留している．その他のチャネルには振動成分が分離されている．また，チャネル2の3$\sim$5Hzにも心拍成分が分離してしまっている．Fig. \ref{fig:hrilrma1}は推定信号に対して心拍推定アルゴリズムを適用した推定心拍値である．IVAを適用したFig. \ref{fig:fhriva64ch3}と比較すると，非常にリファレンスデータに近い心拍推定値となっている．しかし，振動の開始時と終了時はリファレンスデータに対して心拍推定値に差が表れている．

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_ILRMA1_64_est.pdf}
\caption{Estimated signal obtained by ILRMA without partitioning function.}
\label{fig:silrma1}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/hrfig/hr_ILRMAtype1_64_ch3.pdf}
\caption{Estimated heart rate obrtained by ILRMA without partitioning function.}
\label{fig:hrilrma1}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\subsection{基底数可変型LRMAを適用した結果}
\label{sec:conv:resultilrma2}
%----------------------------------------------
Fig. \ref{fig:silrma2}は基底数可変型ILRMAを適用した推定信号である．チャネル3のスペクトログラムに心拍成分が多く分離されている．また，Fig. \ref{fig:silrma1}と比較するとチャネル2に分離されていた心拍成分がチャネル3におおよそ分離できている．Fig. \ref{fig:hrilrma2}は推定信号に対して心拍推定アルゴリズムを適用した推定心拍値である．基底数固定型ILRMAを適用したFig. \ref{fig:heilrma1}と比較すると，振動開始時に大きく差が表れていた心拍値がよりリファレンスデータの心拍値に近い値を示している．

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_ILRMA2_64_est.pdf}
\caption{Estimated signal obtained by ILRMA with partitioning function.}
\label{fig:silrma2}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/hrfig/hr_ILRMAtype2_64_ch3.pdf}
\caption{Estimated heart rate obtained by ILRMA with partitioning function.}
\label{fig:hrilrma2}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\subsection{$t$-ILRMAを適用した結果}
\label{sec:conv:resulttilrma}
%----------------------------------------------
Fig. \ref{fig:stilrmaa5}は$p=1$, $\nu = 5$，\ref{fig:stilrmap5}は$p=2$, $\nu = 5$で$t$-ILRMAを適用した推定信号である．Fig. \ref{fig:silrma1}, Fig. \ref{fig:silrma2}よりチャネル3に品p九成分が分離できている．Fig. \ref{fig:hrtilrmaa5}, Fig. \ref{fig:hrtilrmap5}はFig. \ref{fig:stilrmaa5}，\ref{fig:stilrmap5}に心拍推定アルゴリズムを適用した推定心拍値である．$p$の値を変更したことによる心拍推定結果の差はほとんど見られない．Fig. \ref{fig:hrilrma1}に比べて，振動開始時の心拍推定値のリファレンスデータの心拍値に対する差が小さい．Fig. \ref{fig:hrilrma2}では振動終了時にリファレンスデータの心拍値と差があったが

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_tILRMA_ampdom_dofp5_64_est.pdf}
\caption{Estimated signal obtained by $t$-ILRMA, where $p=1$ and $\nu=5$.}
\label{fig:stilrmaa5}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_tILRMA_powdom_dofp5_64_est.pdf}
\caption{Estimated signal obtained by $t$-ILRMA, where $p=2$ and $\nu=5$.}
\label{fig:stilrmap5}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/hrfig/hr_tILRMA_ampdom_dofp5_64_ch3.pdf}
\caption{Estimated heart rate obtained by $t$-ILRMA, where $p=1$ and $\nu=5$.}
\label{fig:hrtilrmaa5}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/hrfig/hr_tILRMA_powdom_dofp5_64_ch3.pdf}
\caption{Estimated heart rate obtained by $t$-ILRMA, where $p=2$ and $\nu=5$.}
\label{fig:hrtilrmap5}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
本章では，\ref{chap:bsshrexp}章の測定信号に混在している呼吸をカットするためのフィルタについて説明した．また，フィルタリングした測定信号に対して\ref{chap:methods}章で述べた各手法を適用し，スペクトログラムと心拍推定グラフを出力し結果を説明した．$t$-ILRMAが最も分離制度が高いことを示した．