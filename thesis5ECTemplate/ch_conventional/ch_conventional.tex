\chapter{振動測定系と測定信号}
\label{chap:measurementstructsig}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，本研究で扱う信号の測定条件と得られる信号について説明する．
\textcolor{red}{まず\ref{sec:conv:measurementcondition}節では，本研究で使用する観測信号の測定条件，及び観測信号から分離した心拍信号と比較する正解値として用いる接触型ECGセンサについて説明する．
\ref{sec:conv:signal}節では，\ref{sec:conv:measurementcondition}節で述べた測定条件から得られる時間波形，及び時間波形にSTFTを適用して得られるパワースペクトログラムについて説明する．また，接触型ECGセンサから得られる信号にSTFTを適用し，観測信号のパワースペクトログラムと比較することで振動台の成分，心拍，呼吸，及び体動等のその他の成分を確認する．
\ref{sec:conv:conclusion2}節では，本章のまとめを述べる．}

%----------------------------------------------
\section{測定条件}
\label{sec:conv:measurementcondition}
%----------------------------------------------
本研究で使用する信号の\textcolor{red}{振動測定系}はFig.~\ref{fig:sensorstructure}に示すとおりである．\textcolor{red}{運転者を模した}被験者が座った状態で\textcolor{red}{振動測定系}全体を振動させる．Fig.~\ref{fig:sensorimg}に示されている\textcolor{red}{レーダセンサ}を，\textcolor{red}{背部と臀部にあたるシートの内部に埋め込み}，測定を行う．レーダセンサのサンプリング周波数は40~Hzである．\textcolor{red}{振動測定系の振動はsin波の単軸加振であり，Fig.~\ref{fig:sensorstructure}に示す通り，前後・上下・左右方向に振動する．本研究で使用したデータはTable~\ref{tab:vibevacondition}に示すようにNo.~0--No.~6まである．No.~0は振動を加えずに運転者を模した被験者を観測しており，このデータのみ観測時間が5分となっている．No.~1--No.~6のデータは観測時間が7分である．観測開始から1分間は振動を加えていない状態で観測し，その後の5分間は振動を加えた状態，残りの1分間は再度，振動を加えていない状態で観測している．振動は上下方向に加えている．No.~1--No.4~の振幅値はそれぞれ，4~mm, 10~mm, 40~mm, 40~mmで周波数の値は1.2~Hz，No.~5,及びNo.~6の振幅値はそれぞれ4~mm, 10~mmで周波数の値は2.4~Hzとなっている．また，No.~4では，振動の軽減の程度を確認するために被験者はハンドルを握りシートベルトを着用している．}

\textcolor{red}{また，本研究では，分離した信号と比較する正解値としてFig.~\ref{fig:ecgsensor}に示すBiopac社の接触型ECGセンサ，Zephr~Bioharnessを用いて心拍のリファレンスデータを取得する．接触型ECGであるため，振動台の振動が加えられても高精度な心拍値を得ることが可能である．但し，\ref{chap:intro}章で述べた通りこのセンサは接触型であるので，本研究ではこのセンサから得られる心拍値と同程度の制度をレーダセンサから得られること目的としている．接触型ECGセンサはTable~\ref{tab:ecgdata}に示すように，ECGセンサ生データ，ピエゾセンサ生データ，R-R間隔（R-R interval: RRI），心拍数，呼吸数，及び呼吸の深さを測定する．また，サンプリング周波数は250~Hzである．}


%-%-%-%-%-%-%-%-%
\begin{table}[tb]
  \caption{\textcolor{red}{Evaluation conditions using vibration measurement sysytem.}}
  \centering
  \scalebox{1.0}[1.0]{
  \begin{tabular}{|c|c|c|c|} \hline
    Data no.~ & Vibration direction & Amplitude~[mm] & Frequency~[Hz] \\ \hline \hline
    0 & No vibration & - & - \\ \hline
    1 & \multirow{6}{*}{Up and Down} & 4 & 1.2  \\ \cline{1-1} \cline{3-4}
    2 & & 10 & 1.2 \\ \cline{1-1} \cline{3-4}
    3 & & 40 & 1.2 \\ \cline{1-1} \cline{3-4}
    4 & & 40 & 1.2 \\ \cline{1-1} \cline{3-4}
    5 & & 4 & 2.4 \\ \cline{1-1} \cline{3-4}
    6 & & 10 & 2.4 \\ \hline
  \end{tabular}
  }
  \label{tab:vibevacondition}
\end{table}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=0.45\hsize]{./ch_conventional/fig/ecgsensor.pdf}
\caption{\textcolor{red}{Contact ECG sensor \cite{bioharness}.}}
\label{fig:ecgsensor}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{table}[tb]
  \caption{\textcolor{red}{Data obtained by contact ECG sensor.}}
  \centering
  \scalebox{1.0}[1.0]{
  \begin{tabular}{|c|c|c|c|c|c|} \hline
    \begin{tabular}{c} 
    Raw data \\
    obtained by \\
    ECG sensor \\
    \relax [mV]
    \end{tabular} &
    \begin{tabular}{c} 
    Raw data \\
    obtained by \\
    piezo sensor \\
    \relax [mV]
    \end{tabular} &
    \begin{tabular}{c}
    RRI \\
    \relax [sec]
    \end{tabular} &
    \begin{tabular}{c}
    Heart \\
    rate \\
    \relax [bpm]
    \end{tabular} &
    \begin{tabular}{c}
    Breathing \\
    rate \\
    \relax [bpm]
    \end{tabular} &
    \begin{tabular}{c}
    Depth \\
    of \\
    breathing
    \end{tabular} \\ \hline \hline
    54.5852 & 0.0574969 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0574969 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864	\\ \hline
    54.4779 & 0.0573748 & 0.759 & 91 & 18 & 11.864    \\ \hline
    \vdots & \vdots & \vdots & \vdots & \vdots & \vdots \\ \hline	
  \end{tabular}
  }
  \label{tab:ecgdata}
\end{table}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{測定で得られる信号}
\label{sec:conv:signal}
%----------------------------------------------
\ref{sec:conv:measurementcondition}節の\textcolor{red}{振動測定系}によって得られる\textcolor{red}{観測信号はFig.~\ref{fig:sensorimg}に示すように4チャネルの時間波形である．一例として，Tabel~\ref{tab:vibevacondition}に示すData no.~1の時間波形をFig.~\ref{fig:obssig}に示す．このとき，横軸及び縦軸は，それぞれ測定時間及び体表面の変位量となっている．\ref{sec:conv:measurementcondition}節で述べた通り，Fig.~\ref{fig:obssig}の60秒から360秒の間で振動が加えられているため時間波形が他の時間の時間波形とは異なっていることがわかる．振動が加えられていない時間での時間波形には，心拍，呼吸，及び，体動の信号に由来する成分が現れている．また，レーダセンサはチャネル間で近い距離にビームを当てて測定しているため，完全に一致した時間波形ではないが，チャネル間に強い相関を持っていることも確認できる．}

\textcolor{red}{また，観測信号にSTFTを適用して得られる，パワースペクトログラムをFig.~\ref{fig:4chobsspect}に示す．Fig.~\ref{fig:4chobsspect}は4チャネルのパワースペクトログラムで，カラーマップは4チャネルで共通化している．Fig.~\ref{fig:1chobsspect}はFig.~\ref{fig:4chobsspect}のCh.~1のパワースペクトログラムである．60秒から360秒までの間に約1.2~Hz，そしてその整数倍の2.4~Hz, 3.6~Hz, 4.8~Hz, 6.0~Hz, 及び7.2~Hzの直線の成分は振動台による振動成分である．呼吸成分が約0.3~Hzに，そして1.5~Hz, 3.2~Hz, 4.0~Hzに呼吸の高調波成分が確認できる．このように時間波形をスペクトログラムに描画することで，振動台の振動成分，心拍や呼吸由来の成分，及び体動等のその他の成分が確認できる．}

%-%-%-%-%-%-%-%-%
\begin{figure}[b]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/obsSig.pdf}
\caption{\textcolor{red}{Four-channel observed signals obtained by radar sensor.}}
\label{fig:obssig}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/obsSpect.pdf}
\caption{\textcolor{red}{Spectrograms of four-channel observed signals calculated by STFT.}}
\label{fig:4chobsspect}
\end{figure}
%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/1chobsspect.pdf}
\caption{\textcolor{red}{Each component in spectrogram of observed signal calculated by STFT.}}
\label{fig:1chobsspect}
\end{figure}
%-%-%-%-%-%-%-%

%----------------------------------------------
\section{本章のまとめ}
\label{sec:conv:conclusion2}
%----------------------------------------------
\textcolor{red}{本章では，振動測定系の測定条件と測定によって得られる時間波形について説明した．また，観測信号から心拍信号を分離した際に比較を行うために使用した接触型ECGセンサから得られる信号ついて説明た．その信号にSTFTを適用して得られたパワースペクトログラムを時間波形のパワースペクトログラムを比較し，振動台の振動成分，心拍，呼吸，及び体動等のその他の成分を確認した．
次章では，本研究でBSSを適用する動機を述べる．時間周波数領域のBSSの定式化を行い，Itakura--Saitoダイバージェンスに基づくNMF（Nonnegative matrix factorization based on Itakura-Saito divergence: ISNMF）の説明を行う．また観測信号から心拍信号を分離するために適用するIVA, ILRMA，$t$-ILRMA，及び心拍推定アルゴリズムについて説明する．}


\chapter{適用手法}
\label{chap:methods}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，本研究で適用した手法について説明する．
まず\ref{sec:conv:researchmotivation}節では，\textcolor{red}{\ref{chap:measurementstructsig}章の振動測定系において運転者の体表面とレーダセンサの相対的な位置関係は未知であること，及び音響信号処理分野で高度に発展していることから，BSSを観測信号に適用することの妥当性及び動機について述べる．}
\ref{sec:conv:bssformularization}節では，時間周波数領域におけるBSSの定式化を行う．
\textcolor{red}{\ref{sec:conv:iva}節では，音響信号処理分野で有名な周波数領域BSSの一つであるIVAについて説明する．}
\ref{sec:conv:isnmf}節では，行列分解の手法の一つであるNMFのうちISNMFについて説明する
\textcolor{red}{\ref{sec:conv:ilrma}節及び\ref{sec:conv:tilrma}節では，IVAと同様に音響信号処理分野で有名な周波数領域BSSであるILRMA（基底数固定型及び基底数可変型）及び複素Student's $t$分布を生成モデルと仮定する$t$-ILRMAについて説明する．
\ref{sec:conv:heartrateestalgo}節では，\ref{sec:conv:iva}節，\ref{sec:conv:ilrma}節及び\ref{sec:conv:tilrma}節で説明する三つの手法によって得られる分離信号の心拍推定精度を確認するために用いる心拍推定アルゴリズムについて説明する．}

%----------------------------------------------
\section{本研究の動機}
\label{sec:conv:researchmotivation}
%----------------------------------------------
\textcolor{red}{運転者の体表面とレーダセンサの相対的な位置関係は未知としたまま心拍推定を行えることが望ましい．従って，BSSと呼ばれる手法を\ref{chap:measurementstructsig}章で述べた観測信号に適用することは妥当であると考えられる．さらに，BSSはとりわけ音響信号処理分野で高度に発展してきた歴史を持つ．音響信号処理分野では残響による信号源（音源）の混合が部屋の残響などによる畳み込み混合となってしまうため，時間領域でのBSSでは音源を分離することはできない．そのため，観測信号にSTFTを適用して時間周波数領域でBSSを行う手法が長く研究されており，近年においては，IVAやILRMA等，高度に発展したアルゴリズムが提案されている．本論文では前述の音響信号処理分野で高度に発展したBSSアルゴリズムをレーダセンサから観測された4チャネルの信号に適用し，心拍由来の信号，呼吸，及び体動由来の信号等の分離が可能であるか，実験的に調査する．}

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=0.75\hsize]{./ch_conventional/fig/bss.pdf}
\caption{Process of BSS.}
\label{fig:bss}
\end{figure}
%-%-%-%-%-%-%-%-%


%----------------------------------------------
\section{BSSの定式化}
\label{sec:conv:bssformularization}
%----------------------------------------------

\textcolor{red}{音響信号処理分野におけるBSSでは，録音時の部屋の残響や音速の遅さ等に起因して，音源の混合現象は時間領域での瞬時混合（Fig.~\ref{fig:bss}における混合行列$\bm{A}$の行列積）ではなく，畳み混み混合になる．このような複雑な混合系を持つ観測信号を単純な瞬時混合でモデル化するために，観測信号にSTFTを適用し，時間領域から時間周波数領域の信号に変換することが一般的である．時間領域での畳み込み混合は，時間周波数領域での瞬時混合とみなせるため，Fig.~\ref{fig:bss}に示すような混合系を周波数ごとに考えればよい．
このような混合系のモデル化に基づくBSSを周波数領域BSSと呼ばれ，音響信号処理においては効果的な音源分離を達成するための重要なモデルとなっている．本論文で取り扱うBSSであるIVA及びILRMAはいずれも周波数領域のBSSの一つである．}

以下に，周波数領域BSSの定式化を行う．
複数の\textcolor{red}{信号源}が混合している観測信号\textcolor{red}{において，信号源数及び観測チャネル数（センサ数）}をそれぞれ$N$及び$M$と定義する．
混合前の信号源，観測信号，及び分離信号に対して\textcolor{red}{STFTを適用したものをそれぞれ次式で定義する．}
\begin{align}
\bm{s}_{ij} &= [s_{ij1}, s_{ij2}, \cdots, s_{ijn}, \cdots, s_{ijN}]^{\mathrm{T}} \in \mathbb{C}^{N} \label{eq:s} \\
\bm{x}_{ij} &= [x_{ij1}, x_{ij2}, \cdots, x_{ijm}, \cdots, x_{ijM}]^{\mathrm{T}} \in \mathbb{C}^{M} \label{eq:x} \\
\bm{y}_{ij} &= [y_{ij1}, y_{ij2}, \cdots, y_{ijn}, \cdots, y_{ijN}]^{\mathrm{T}} \in \mathbb{C}^{N} \label{eq:y}
\end{align}
ここで，\textcolor{red}{$i=1, 2,  \cdots, I$, $j=1, 2,  \cdots, J$, $n=1, 2,  \cdots, N$, 及び$m=1, 2, \cdots, M$はそれぞれ周波数ビン，時間フレーム，信号源，及びチャネルのインデクスを表す．ここで，$^{\mathrm{T}}$は行列及びベクトルの転置を表す．また，式(\ref{eq:s})--(\ref{eq:y})の各信号においては，時間周波数行列としての表記もそれぞれ$\bm{S}_n\in\mathbb{C}^{{I\times J}}$, $\bm{X}_m\in\mathbb{C}^{{I\times J}}$，及び$\bm{Y}_n\in\mathbb{C}^{{I\times J}}$として定義しておく．}
\textcolor{red}{式(\ref{eq:s})--(\ref{eq:y})において}，周波数ごとの時不変な（時間フレーム$j$に依存しない）混合行列$\bm{A}_i \in \mathbb{C}^{M\times N}$を用いると，混合時の\textcolor{red}{畳み込み長}がSTFTの短時間信号長（窓長）$L$よりも十分に短い場合，観測信号は次式で表せる.
\begin{align}
  \bm{x}_{ij} = \bm{A}_i \bm{s}_{ij} \label{eq:xas}
\end{align}
ここで，$M=N$\textcolor{red}{（信号源数とチャネル数が等しい）}かつ$\bm{A}_i$がフルランクの場合は，分離行列$\bm{W}_{i} = [\bm{w}_{i1}~\bm{w}_{i2}~\cdots~ ~\bm{w}_{iN}]^{\mathrm{H}} \in \mathbb{C}^{N \times M} $が存在し，分離信号は次式で表せる．
\begin{align}
  \bm{y}_{ij} = \bm{W}_i \bm{x}_{ij} \label{eq:ywj}
\end{align}
ここで，$^{\mathrm{H}}$は行列及びベクトルのエルミート転置を表す．
\textcolor{red}{周波数領域BSSは周波数ごとの混合行列$\bm{A}_i$が未知の状態で周波数ごとの分離行列$\bm{W}_{i} \approx \bm{A}_i^{-1}$}を全ての周波数$i=1, 2, \cdots, I$において推定する問題である．


%----------------------------------------------
\section{IVA}
\label{sec:conv:iva}
%----------------------------------------------
%-%-%-%-%-%-%-%-%
\begin{figure}[t]
\centering
\includegraphics[width=0.95\hsize]{./ch_conventional/fig/iva.pdf}
\caption{Mixing and demixing models in IVA, where $M=N=2$.}
\label{fig:ivamodel}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[t]
\centering
\includegraphics[width=0.8\hsize]{./ch_conventional/fig/laplace_sav.pdf}
\caption{Zero-mean and spherically symmetric Laplace distribution, where $I=2$ and $s^*_{ijn}$ can be considered as either real or imaginary part of $s_{ijn}$.}
\label{fig:laplace}
\end{figure}
%-%-%-%-%-%-%-%-%
\textcolor{red}{本節では，音響信号処理分野で有名な周波数領域のBSSの一つであるIVAについて概説する．信号源，観測信号，及び分離信号のそれぞれについて，全ての周波数ビンに関する成分をまとめたベクトルを次のように定義する．}
\begin{align}
    \overline{\bm{s}}_{jn} &= [s_{1jn}, s_{2jn}, \cdots, s_{ijn}, \cdots, s_{Ijn} ]^{\mathrm{T}} \in \mathbb{C}^{I} \\
    \overline{\bm{x}}_{jm} &= [x_{1jm}, x_{2jm}, \cdots, x_{ijm}, \cdots, x_{Ijm} ]^{\mathrm{T}} \in \mathbb{C}^{I} \\
    \overline{\bm{y}}_{jn} &= [y_{1jn}, y_{2jn}, \cdots, y_{ijn}, \cdots, y_{Ijn} ]^{\mathrm{T}} \in \mathbb{C}^{I}
\end{align}
Fig. \ref{fig:ivamodel}に$M=N=2$の場合\textcolor{red}{におけるIVAの混合系及び分離系のモデル図を示す．}
IVAは\textcolor{red}{周波数領域BSSであるため，周波数ごとの分離行列}$\bm{W}_i$を推定する．
ただし，推定の過程\textcolor{red}{において，}全周波数を含む$I$次元\textcolor{red}{複素}分布を\textcolor{red}{$\overline{\bm{s}}_{jn}$の生成モデルと仮定されている．さらに，この}$I$次元ベクトル内には高次相関\textcolor{red}{（ベクトル内の要素の共起性）があることを仮定している．}
このIVAの生成モデルには，Fig. \ref{fig:laplace} で示すような\textcolor{red}{$I$次元球対称複素Laplace分布}が用いられ，式(\ref{eq:iva_model})で表される．
\begin{align}
  \nonumber p(\overline{\bm{s}}_{jn}) &= p(\overline{\bm{y}}_{jn}) \\
&= \frac{1}{\pi \prod_{i} \sigma_{in}} \exp \left(  - \sqrt{ \sum_i \left| \frac{y_{ijn}}{\sigma_{in}} \right|^2}  \right)
\label{eq:iva_model}    
\end{align}
ここで，$\sigma_{in}>0$はスケールパラメタである．
式(\ref{eq:iva_model})の分布は球対称性を持つため，同一ベクトル内の成分が高次相関を持つ\cite{Kim2007_iva}．
したがって，IVAは同時に生起する周波数成分を一つの\textcolor{red}{信号源}としてまとめる傾向がある．\textcolor{red}{この性質は，信号源が基本周波数成分とその整数倍の周波数成分からなる場合（調波構造を持つ場合）に，それらの成分を同一の信号源の成分とみなすことに対応する．本論文で扱う信号源においては，Fig.~\ref{fig:4chobsspect}に示されるように，心拍由来の成分や振動台で加振される成分などに顕著な調波構造がみられる．そのため，IVAが仮定する周波数間の高次相関は，本論文が対象とする観測信号や信号源に対しても有効であると考えられる．}

\textcolor{red}{信号源}周波数ベクトル間の独立性$p(\overline{\bm{y}}_{j1}, \overline{\bm{y}}_{j2}, \cdots, \overline{\bm{y}}_{jN}) = \prod_n p(\overline{\bm{y}}_{in})$を仮定すると，IVAの観測信号に対する負対数尤度関数は次式で得られる．
\begin{align}
    \mathcal{L} = -2J \sum_i \log |\det \bm{W}_i| + \sum_{j,n} G(\overline{\bm{y}}_{j,n})
    \label{eq:ivalike}
\end{align}
ここで，$G(\overline{\bm{y}}_{jn})$はコントラスト関数と呼ばれ，次式で定義される．
\begin{align}
  \nonumber G(\overline{\bm{y}}_{jn}) &= -\log p(\overline{\bm{y}}_{j,n}) \\
  &= -\log \frac{1}{\pi \prod_{i} \sigma_{in}} \exp \left(  - \sqrt{ \sum_i \left| \frac{y_{ijn}}{\sigma_{in}} \right|^2}  \right)
\end{align}
IVAは, 補助関数法\cite{auxfunc}\textcolor{red}{及び反復射影法（iterative projection: IP）\cite{auxIVA}を用いた最適化アルゴリズムによって，高速かつ安定に分離行列を推定できる\cite{stable_auxIVA}．この反復最適化更新則は下記の通りである．}
\begin{align}
\bm{G}_{in} &= \frac{1}{J} \sum_j \frac{1}{\sqrt{\sum_{i} |\bm{w}_{in}^\mathrm{H}\bm{x}_{ij}|^{2}}} \bm{x}_{ij} \bm{x}_{ij}^{\mathrm{H}} \label{ep:auxIVAip1} \\
\bm{w}_{in} &\leftarrow (\bm{W}_i \bm{G}_{in})^{-1} \bm{e}_n \label{ep:auxIVAip2} \\
\bm{w}_{in} &\leftarrow \bm{w}_{in} ( \bm{w}_{in}^{\mathrm{H}} \bm{G}_{in} \bm{w}_{in} )^{-\frac{1}{2}} \label{ep:auxIVAip3}
\end{align}
ここで，$\bm{e}_{n} \in \mathbb{R}^{N}_{\{0,1\}}$は$n$番目の要素が,他要素が0のベクトルである．
\textcolor{red}{式（\ref{ep:auxIVAip1}）--（\ref{ep:auxIVAip3}）を反復計算して分離行列$\bm{W}_i$を求めることができる．なお，この反復最適化アルゴリズムは1回の更新で負対数尤度関数（\ref{eq:ivalike}）の値が減少する（または変動しない）ことが理論的に保証されている．}


%----------------------------------------------
\section{ISNMF}
\label{sec:conv:isnmf}
%----------------------------------------------

\textcolor{red}{本節では，次節で取り扱う周波数領域BSSであるILRMAを説明するために必要なNMF~\cite{NMF}の理論（特にISNMFの生成モデル）について概説する．}
NMFとは行列分解の方法の一つである．\textcolor{red}{非負行列を低ランク近似する数理アルゴリズムの一つである．特に，少数の非負の来てベクトルを教師なし学習として推定できるため，観測された非負行列に含まれる非負潜在パターンを抽出することが可能である．音響信号処理分野では，NMFに基づくBSSも数多く提案されている\cite{singlechsep, supNMF, MNMF_oz, iwase}．}

単一チャネルの\textcolor{red}{観測信号（時間波形）にSTFTを適用して得られる複素スペクトログラムを$\bm{B}\in\mathbb{C}^{I\times J}$とする．この$\bm{B}$に対するパワースペクトログラムを$|\bm{B}|^{.2}$と表記する．ここで，行列に対する$|\cdot|$及びドット付きの指数乗はそれぞれ要素毎の絶対値及び要素毎の次数場を表す．パワースペクトログラムは非負行列であるため，NMFで次式のように低ランク近似することが可能である．}

\begin{align}
    |\bm{B}|^{.2} = \bm{TV}　\label{eq:powerspect}
\end{align}
ここで，$\bm{T} \in \mathbb{R}^{I \times K}_{\geq 0}$を基底行列，$\bm{V} \in \mathbb{R}^{K \times J}_{\geq 0}$をアクティベーション行列という．
\textcolor{red}{また，$\bm{T}$の列数及び$\bm{V}$の行数である$K$は事前に設定するパラメタであり，式（\ref{eq:powerspect}）の右辺（モデル行列$\bm{TV}$）のランクに対応する．}通常は$K \ll \min (I,J)$となるように設定される．
\textcolor{red}{一例として，音響信号のパワースペクトログラムを$K=2$のNMFで低ランク近似した様子をFig. \ref{fig:nmf_ps}に示す．このような場合，パワースペクトログラム中に頻繁に出現するスペクトルパターンが2本の基底ベクトル（基底行列$\bm{T}$の列ベクトル）として抽出され，またそれらの時間的な強度変化がアクティベーションベクトル（アクティベーション行列の行ベクトル）に現れる．}

\textcolor{red}{ISNMFでは，}基底行列$\bm{T}$とアクティベーション行列$\bm{V}$は次式の最小化問題の解として推定される．

\begin{align}
    \min_{\bm{T,V}} \mathcal{D}(|\bm{B}|^{.2} | \bm{TV}) ~~\mathrm{s.t.} ~ t_{ik}, v_{kj} \geq 0 ~~\forall i,~j,~k
\end{align}
\begin{align}
    \mathcal{D}(|\bm{B}|^{.2}|\bm{TV}) = \sum_{i,j}\left[ \frac{ |b_{ij}|^2 }{ \sum_{k}t_{ik}v_{kj} } - \log{\frac{ |b_{ij}|^2 }{ \sum_{k}t_{ik}v_{kj}}} -1 \right] \label{eq:matrixisdiv}
\end{align}
ここで，\textcolor{red}{$b_{ij}$，$t_{ik}$，及び$v_{kj}$はそれぞれ$\bm{B}$, $\bm{T}$, 及び$\bm{V}$}の要素である．
また，\textcolor{red}{$k= 1, 1, \cdots, K$は基底ベクトルのインデクスを表す．さらに，式（\ref{eq:matrixisdiv}）}は2つの行列（$|\bm{B}|^{.2}$及び$\bm{TV}$）間の類似度を測る関数で\textcolor{red}{あり，Itakura--Saitoダイバージェンスと呼ばれる．}ISNMFの$\bm{T}$及び$\bm{V}$の最適化のための反復更新式は式(\ref{eq:MUT})及び式(\ref{eq:MUV})で表される\cite{MU}．

\begin{align}
    t_{ik} \leftarrow t_{ik} \sqrt \frac{ \sum_j |b_{ij}|^2 v_{kj} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-2} }{ \sum_j v_{kj} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-1} } \label{eq:MUT} \\
    v_{kj} \leftarrow v_{kj} \sqrt \frac{ \sum_i |b_{ij}|^2 t_{ik} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-2} }{ \sum_i t_{ik} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-1} } \label{eq:MUV}
\end{align}
この更新式は乗算型反復更新式と呼ばれ，目的関数が単調非増加\textcolor{red}{となる}ことが保証されている．

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=0.95\hsize]{./ch_conventional/fig/NMF_ps.pdf}
\caption{NMF decomposition of power spectrogram of ordio signal, where $K=2$.}
\label{fig:nmf_ps}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[!b]
\centering
\includegraphics[width=0.8\hsize]{./ch_conventional/fig/gauss_sav.pdf}
\caption{Circularly symmetric complex Gaussian distribution.}
\label{fig:gauss}
\end{figure}
%-%-%-%-%-%-%-%-%

\textcolor{red}{ISNMFは，複素スペクトログラムに対する生成モデルを仮定した最尤推定問題と等価である~\cite{isnmf}．次節で述べるBSSアルゴリズムのILRMAの説明には，ISNMFの生成モデルが必要であるため，本節で述べる．}
\textcolor{red}{複素スペクトログラムである$\bm{B}$の要素である$b_{ij}$が，次式のように複素部分成分$c_{ijk}$に分解されることを仮定する．}
\begin{align}
    b_{ij} = \sum_k c_{ijk}　\label{eq:zijmodel}
\end{align}
\textcolor{red}{このとき，複素部分成分$c_{ijk}$に対して次式の生成モデルを仮定する．}
\begin{align}
    c_{ij,k} \sim \mathcal{N}_{\mathbb{C}} (c_{ijk}; 0, t_{ik}v_{kj})
\end{align}
ここで，$c_{ijk}\in \mathbb{C}$は全ての$i$，$j$, 及び$k$に関して互いに独立と仮定する．
また，$c$を複素数の確率変数としたとき，\textcolor{red}{$\mathcal{N}_{\mathbb{C}} (c; \mu, \sigma^2)$は原点対称複素Gauss分布を表し，その確率密度関数は次式で与えられる．}
\begin{align}
    \mathcal{N}_{\mathbb{C}} (c; \mu, \sigma^2) &= \frac{1}{\pi \sigma^2} \exp \left( -\frac{|c-\mu|^2}{\sigma^2} \right) \label{eq:compGausiandist}
\end{align}
ここで，$\mu$及び$\sigma^2$はそれぞれ平均及び分散を示す．\textcolor{red}{この分布の外形をFig. \ref{fig:gauss}に示す．式（\ref{eq:compGausiandist}）は再生性を持つ分布であるため，式（\ref{eq:zijmodel}）で構成される$b_{ij}$もまた次式の生成モデルを持つことになる．}
\begin{align}
    b_{ij} \sim \mathcal{N}_{\mathbb{C}}\left( b_{ij}; 0, \sum_k t_{ik} v_{kj} \right) \label{eq:nmfgen}
\end{align}
\textcolor{red}{ISNMFでは}，観測信号$b_{ij}$が与えられた場合における$t_{ik}$及び$v_{kj}$の最尤推定問題を考える．
このとき，尤度関数は
\begin{align}
    \mathcal{L}(\bm{T}, \bm{V}) = \prod_{i,j} \frac{1}{\pi \sum_k t_{ik} v_{kj} } \exp \left( -\frac{|b_{ij}|^2}{\sum_k t_{ik} v_{kj}} \right)
\end{align}
となり，負対数尤度\textcolor{red}{関数}は
\begin{align}
    -\log\mathcal{L}(\bm{T}, \bm{V}) = \sum_{i,j} \left( \frac{|b_{ij}|^2}{\sum_k t_{ik} v_{kj}} + \log \sum_k t_{ik} v_{kj} + \log \pi \right) \label{eq:negativeloglikelihood}
\end{align}
で表される．
\textcolor{red}{式（\ref{eq:negativeloglikelihood}）は，パワースペクトログラム$|B_{ij}|^2$に対するISNMFの目的関数（\ref{eq:matrixisdiv}）と定数部分の違いを除いて一致する．そのため，負対数尤度関数は以下のように書き換えられる．}
\begin{align}
    -\log\mathcal{L}(\bm{T}, \bm{V}) = \mathcal{D} \left( |B|^{.2} | \bm{TV} \right) + \mathrm{const.}
    \label{eq:isnmf}
\end{align}
\textcolor{red}{この事実は，パワースペクトログラム$|\bm{B}|^{.2}$にISNMFを適用することが，式(\ref{eq:nmfgen})の生成モデルを仮定した分散の最尤推定問題と等価であることを示している．}

%----------------------------------------------
\section{ILRMA}
\label{sec:conv:ilrma}
%----------------------------------------------

\textcolor{red}{IVAよりも高精度なBSSを達成できるアルゴリズムとしてILRMA\cite{ILRMA, Kitamura2018_ilrma}が提案されている．本論文においても，ILRMAに基づく心拍信号のBSSを検討するため，本節ではILRMAの生成モデル及び反復更新式について概説する．}

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=0.95\hsize]{./ch_conventional/fig/ilrmaoutline.pdf}
\caption{Parameter updates of ILRMA.}
\label{fig:ilrma_outline}
\end{figure}
%-%-%-%-%-%-%-%-%

ILRMAの反復最適化の概要をFig. \ref{fig:ilrma_outline}に示す．
\textcolor{red}{図中の}$\bm{T}_n\in\mathbb{R}_{\geq 0}^{I\times K}$及び$\bm{V}_n\in\mathbb{R}_{\geq 0}^{K\times J}$は，$n$番目の\textcolor{red}{信号源}のパワースペクトログラム\textcolor{red}{$|\bm{Y}_n|^{.2}$をISNMFで低ランク近似したモデル$\bm{T}_n\bm{V}_n$の基底行列及びアクティベーション行列である．}
ILRMAは, IVAに\textcolor{red}{基づく}分離行列$\bm{W}_i$の反復最適化とISNMF\textcolor{red}{による分離信号源$|\bm{Y}_n|^{.2}$の}低ランクモデリングに対応する$\bm{T}_n\bm{V}_n$の反復最適化が交互に行われる．
具体的には，分離行列$\bm{W}_i$により推定された分離信号\textcolor{red}{$|\bm{Y}_n|^{.2}$}をISNMF\textcolor{red}{で非負低ランク行列としてモデル化し}，得られた$\bm{T}_n$及び$\bm{V}_n$の各時間周波数成分を式(\ref{eq:nmfgen})における分散（各音源の生成モデルの推定パラメタ）に用いて分離行列\textcolor{red}{$\bm{W}_i$}を再度推定する，というプロセスが反復的に行われる．

ILRMAの生成モデルはISNMFと同様に次式の複素ガウス分布\textcolor{red}{が仮定されている．}
\begin{align}
    y_{ijn} &= \sum_k c_{ijnk} \\
    c_{ijnk} &= \mathcal{N}_{\mathbb{C}}(c_{ijnk}; 0, t_{ikn} v_{kjn}) \label{eq:ilrma_gen}
\end{align}
\textcolor{red}{ここで，$t_{ikn}$及び$v_{kjn}$は$\bm{T}_n$及び$\bm{V}_n$の要素である．}
また，$c_{ijnk} \in \mathbb{C}$は\textcolor{red}{$i, j, k, $及び$n$に関して}互いに独立であると仮定する．
このとき，観測\textcolor{red}{信号$(\bm{X}_n)_{n=1}^N$}が与えられた場合において, $\bm{W}_i$，$\bm{T}_n$, 及び$\bm{V}_n$を最尤推定する問題を考える．
ISNMFの\textcolor{red}{生成モデルより，}
\begin{align}
    y_{ijn} \sim \mathcal{N}_{\mathbb{C}}\left(y_{ijn};  0, \sum_k t_{ikn} v_{kjn} \right) 
　　\label{eq:ISNMFmodel}
\end{align}
が成り立つので，\textcolor{red}{全分離信号の結合分布は次式で表される．}
\textcolor{red}{
\begin{align}
    \nonumber p(\bm{Y}_1, \bm{Y}_2, \cdots, \bm{Y}_N) &= \prod_n p(\bm{Y}_n) \\
\nonumber &= \prod_{n, i, j} p(y_{ijn}) \\
\nonumber &= \prod_{n, i, j} \mathcal{N}_{\mathbb{C}} \left(y_{ijn}; 0, \sum_k t_{ikn}v_{kjn} \right) \\
&= \prod_{n, i, j} \frac{1}{\pi \sum_k t_{ikn}v_{kjn}} \exp \left( -\frac{|y_{ijn}|^2}{\sum_k t_{ikn}v_{kjn}} \right) \label{eq:combineddist}
\end{align}}
\textcolor{red}{式（\ref{eq:combineddist}）を用いて観測信号の負対数尤度関数を求めると次式となる．}
\textcolor{red}{
\begin{align}
　　\nonumber \mathcal{L}(\mathsf{W, T, V}) &= - \log p(\bm{X}_1, \bm{X}_2, \cdots, \bm{X}_M) \\
    \nonumber &= -\log \left[p(\bm{Y}_1, \bm{Y}_2, \cdots, \bm{Y}_N) \cdot \prod_{i, j} |\det \bm{W}_i|^2\right] \\
    \nonumber &= -\log \left \{ \left[\prod_n p(\bm{Y}_n) \right] \cdot \prod_{i, j} |\det \bm{W}_i|^2\right \} \\
    \nonumber &= \mathrm{const.}- 2J \sum_{i}  \log |\det \bm{W}_i| +\sum_{i,j,n} \left( \frac{|y_{ij}|^2}{\sum_k t_{ikn} v_{kjn}} + \log \sum_k t_{ikn} v_{kjn}\right) \\
    &= \mathrm{const.}-2J \sum_i \log | \det \bm{W}_i | + \sum_{i,j,n} \left( \frac{|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}{\sum_k t_{ikn}v_{kjn}} + \log \sum_k t_{ikn}v_{kjn} \right)
    \label{eq:ilrmalike2}
\end{align}}
ここで，$\mathsf{W}=\{ \bm{W}_i \}_{i=1}^I$，$\mathsf{T}=\{ \bm{T}_n \}_{n=1}^N$, 及び$\mathsf{V}=\{ \bm{V}_n \}_{n=1}^N$は最適化パラメタの集合である．

\textcolor{red}{式（\ref{eq:ilrmalike2}）を最小化するパラメタは，以下に示す反復最適化アルゴリズムで推定される．まず}
式(\ref{eq:ilrmalike2})を見ると，第二項と第三項は式(\ref{eq:negativeloglikelihood})のISNMFの尤度関数\textcolor{red}{等価であることがわかる．従って，式（\ref{eq:ilrmalike2}）を最小化する$\mathsf{T}$及び$\mathsf{V}$はISNMFと同様に，次式の更新式で反復最適化できる．}
\begin{align}
    t_{ikn} \leftarrow t_{ikn} \sqrt \frac{ \sum_j |\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2 v_{kjn} \left( \sum_{k'} t_{ik'n} v_{k'jn} \right)^{-2} }{ \sum_j v_{kjn} \left( \sum_{k'} t_{ik'n} v_{k'jn} \right)^{-1} } \label{eq:MUTilrma} \\
    v_{kjn} \leftarrow v_{kjn} \sqrt \frac{ \sum_i |\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2 t_{ikn} \left( \sum_{k'} t_{ik'n} v_{k'jn} \right)^{-2} }{ \sum_i t_{ikn} \left( \sum_{k'} t_{ik'n} v_{k'jn} \right)^{-1} } \label{eq:MUVilrma}
\end{align}
\textcolor{red}{一方，分離行列$\bm{W}_i$に関する最適化は，分離ベクトル$\bm{w}_{in}$をIPで更新することで達成される．}
\begin{align}
\bm{U}_{in} &= \frac{1}{J} \sum_j \frac{1}{\sum_{l}t_{ikn}v_{kjn}} \bm{x}_{ij} \bm{x}_{ij}^{\mathrm{H}} \label{eq:ip1} \\
\bm{w}_{in} &\leftarrow (\bm{W}_i \bm{U}_{in})^{-1} \bm{e}_n \label{eq:ip2} \\
\bm{w}_{in} &\leftarrow \bm{w}_{in} ( \bm{w}_{in}^{\mathrm{H}} \bm{U}_{in} \bm{w}_{in} )^{-\frac{1}{2}} \label{eq:ip3}
\end{align}

\textcolor{red}{これらの更新式も, IVAやISNMFと同様に，目的関数（\ref{eq:ilrmalike2}）の値が単調非増加となることが保証されている．}

\textcolor{red}{上記のILRMAは基底数$K$が信号源毎に同じ数を設定した場合の定式化であり，以後，基底数固定型ILRMAと呼ぶ．一方で，信号源毎に適切な基底数は未知であるため，全信号源に用いる基底数を$r=1, 2, \cdots, R$と設定したうえで，適応的に各信号源に基底数を割り振る定式も提案されている．以後，この手法を基底数可変型ILRMAと呼ぶ．以下に，基底数可変型ILRMAの定式化及び反復更新式を記載する．}

\textcolor{red}{基底数可変型ILRMAでは，式（\ref{eq:ISNMFmodel}）の生成モデルにおける分散$\sigma_{ijn}^2$を次式で定式化している．}
\begin{align}
\sigma_{ijn}^2 = \sum_{r} z_{nr}t_{ir}v_{ri}
\end{align}
\textcolor{red}{ここで，$z_{nr}\in [0, 1]$は分割関数と呼ばれ，$r$番目の基底を$n$番目の音源に分配する潜在変数である．従って，$\sum_{n} z_{nr} = 1$という制約がある．この分割関数を含めた基底数可変型ILRMAの更新式は次式となる．
\begin{align}
t_{ir}&\leftarrow t_{ir}\sqrt{\dfrac{\sum _{j,n}\left| b_{ijn}\right| ^{2}z_{nr}v_{rj}\left( \sum _{r'}z_{nr'}t_{ir'}v_{r'j}\right) ^{-2}}{\sum _{j,n}z_{nr}v_{rj}\left( \sum _{r'}z_{nr'}t_{ir'}v_{r'j}\right) ^{-1}}} \label{eq:ilrma2ip1} \\
v_{ir}&\leftarrow v_{ir}\sqrt{\dfrac{\sum _{i,n}\left| b_{ijn}\right| ^{2}z_{nr}t_{ir}\left( \sum _{r'}z_{nr'}t_{ir'}v_{r'j}\right) ^{-2}}{\sum _{i,n}z_{nr}t_{ir}\left( \sum _{r'}z_{nr'}t_{ir'}v_{r'j}\right) ^{-1}}} \label{eq:ilrma2ip2} \\
z_{nr}&\leftarrow z_{nr}\sqrt{\dfrac{\sum _{i,j}\left| b_{ijn}\right| ^{2}t_{ir}v_{rj}\left( \sum _{r'}z_{nr'}t_{ir'}v_{r'j}\right) ^{-2}}{\sum _{i,j}t_{ir}v_{rj}\left( \sum _{r'}z_{nr'}t_{ir'}v_{r'j}\right) ^{-1}}} \label{eq:ilrma2ip3} \\
z_{nr}&\leftarrow \dfrac{z_{nr}}{\sum _{n'}z_{nr}} \label{eq:normalizez}
\end{align}}

\textcolor{red}{式（\ref{eq:ilrma2ip1}）--（\ref{eq:ilrma2ip3}）で音源モデルを更新した後は，基底数固定型ILRMAと同様に式（\ref{eq:ip1}）--（\ref{eq:ip3}）で分離行列を更新する．この手続きを反復する．また，式（\ref{eq:normalizez}）は前述した通り，$\sum_{n} z_{nr} = 1$を保証するために計算される．}

\textcolor{red}{本論文では，本節で説明したILRMAに関しては基底数固定型及び基底数可変型の2つのアルゴリズムを適用する．しかしながら，次節で述べる$t$-ILRMAにおいては，基底数固定型のみ適用する．}

%----------------------------------------------
\section{$t$-ILRMA}
\label{sec:conv:tilrma}
%----------------------------------------------

\textcolor{red}{近年，ISNMFの複素Gauss分布に基づくに基づく生成モデルを，一般化したNMFが数多く提案されている．例えば，複素一般化Gauss分布に基づくNMF~\cite{GGD}や複素Student's $t$分布に基づくNMF（$t$-NMF）\cite{tnmf}等が提案されており，NMFに基づく特定のタスク（BSSやスパースノイズ除去等）においてISNMFよりも性能が向上することが報告されている．このことに鑑み，}複素Student's~$t$分布を生成モデル\textcolor{red}{と仮定するILRMA（$t$-ILRMA）が提案された\cite{tdist1, tdist2}．}
複素Student's~$t$分布には形状パラメタ$\nu~\textgreater~0$があ\textcolor{red}{る．$\nu=1$とすると複素Cauchy分布に一致し，$\nu\rightarrow2$とすると複素Gauss分布に一致する．}

$t$-ILRMAの生成モデルは次式で表される．
\textcolor{red}{
\begin{align}
     \prod_{i,j}\left(\bm{Y}_{n}\right)= \prod_{i,j}\frac{1}{\pi \sigma_{ijn}^{2} } \left( 1+\frac{2}{\nu}\frac{|y_{ijn}|^2}{\sigma_{ijn}^{2}} \right)^{\frac{2+\nu}{2}}　\label{eq:tmodel}
\end{align}
\begin{align}
     \sigma_{ijn}^{p}=\left(\sum_{k}t_{ikn}v_{kjn}\right)^{p} \label{eq:tsigma}
\end{align}}

ここで，\textcolor{red}{$\sigma_{ijn}$は時間周波数ごとに変動する非負パラメタであり，分離信号$\bm{Y}_{n}$の振幅スペクトログラム$|\bm{Y}_{n}|$のNMFモデルである．また，}$p$はNMFモデルの\textcolor{red}{信号領域を決定する量であり}，$p=1$のときは振幅ドメイン，$p=2$のときはパワードメインを\textcolor{red}{モデル化することに}相当する．\textcolor{red}{従って}$p=2$\textcolor{red}{かつ}$\nu\rightarrow\infty$のときは，\textcolor{red}{式（\ref{eq:tmodel}）は}ISNMFの\textcolor{red}{生成}モデルに一致\textcolor{red}{する．}この\textcolor{red}{生成モデルの負対数尤度関数が$t$-ILRMAの目的関数であり，次式で与えられる．}
\textcolor{red}{
\begin{align}
    \nonumber \mathcal{L}_{t}(\mathsf{W, T, V}) =& \mathrm{const.}-2J \sum_{i}\log|\mathrm{det}\bm{W}_{i}| \\
&+\sum_{i,j}\left\lbrack\left(1+\frac{\nu}{2}\right)\log\left(1+\frac{2}{\nu}\frac{|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}{\left(\sum_{k}t_{ikn}v_{kjn}\right)^2}\right)+2\log\left(\sum_{k}t_{ikn}v_{kjn}\right)\right\rbrack \label{eq:tcost}
\end{align}}

式（\ref{eq:tcost}）を最小化するNMFの最適化パラメタ$\bm{T}_{n}，\bm{V}_{n}$の更新式は次式で表される．
\textcolor{red}{
\begin{align}
    t_{ikn}\leftarrow t_{ikn}\left\lbrack\frac{\sum_{j}\frac{|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}{\frac{\nu}{\nu+2}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{2}+\frac{2}{\nu+2}|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{-p}v_{kjn}^{-\frac{2}{p}}}{\sum_{i}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{-p}v_{kjn}}\right\rbrack^{\frac{p}{p+2}} \label{eq:tt}
\end{align}
\begin{align}
    v_{lj,n}\leftarrow v_{lj,n}\left\lbrack\frac{\sum_{i}\frac{|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}{\frac{\nu}{\nu+2}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{2}+\frac{2}{\nu+2}|\bm{w}_{in}^{\mathrm{H}}\bm{x}_{ij}|^2}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{-p}t_{il,n}^{-\frac{2}{p}}}{\sum_{i}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{-p}t_{il,n}}\right\rbrack^{\frac{p}{p+2}} \label{eq:tv}
\end{align}}

\textcolor{red}{一方}分離行列$\bm{W}_{i}$は節\ref{sec:conv:ilrma}と同様に分離ベクトル$\bm{w}_{in}$をIPで更新することで達成される．
\begin{align}
    \bm{U}_{in}=\frac{1}{J}\left(\frac{2}{\nu}+1\right)\sum_{j}\frac{1}{\alpha_{ijn}\left(\sum_{k}t_{ikn}v_{kjn}\right)^{2}}\bm{x}_{ij}\bm{x}_{ij}^{\mathrm{H}} \label{eq:tip1}
\end{align}
\begin{align}
    \bm{w}_{in}\leftarrow\left(\bm{W}_{i}\bm{U}_{in}\right)^{-1}\bm{e}_{n} \label{eq:tip2}
\end{align}
\begin{align}
    \bm{w}_{in}\leftarrow\frac{\bm{w}_{in}}{\sqrt{\bm{w}_{in}^{\mathrm{H}}\bm{U}_{in}\bm{w}_{in}}} \label{eq:tip3}
\end{align}
\textcolor{red}{ここで，$\alpha_{ijn}>0$は補助変数である．}

これらの更新式も，\textcolor{red}{IVA, ISNMF, 及びILRMAと同様に，目的関数}(\ref{eq:tcost})の値が単調非増加となることが保証されている．


%----------------------------------------------
\section{心拍推定アルゴリズム}
\label{sec:conv:heartrateestalgo}
%----------------------------------------------

\textcolor{red}{本節では，レーダセンサの観測信号やBSSで推定された心拍信号等に対して適用する心拍推定アルゴリズムについて説明する．なお，本節では単一チャネルの時間信号を処理の対象としている．この時間信号を}$\left(x[l]\right)_{l=1}^{L}$とする．ここで，$l=1, 2, \cdots , L$は離散時間インデクスであり，$L$は\textcolor{red}{信号の}時間長である．\textcolor{red}{本論文で使用する心拍推定アルゴリズムを下記に順を追って示す．また，心拍推定アルゴリズムの処理の流れを以下にFig.~{fig:hralgo}として示す．}

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/hralgo.pdf}
\caption{Process of heart rate estimation algorithm.}
\label{fig:hralgo}
\end{figure}
%-%-%-%-%-%-%-%-%

\textcolor{red}{まず，信号の調波構造を強調しつつ低周波成分を除去するため，次式の二階微分フィルタを信号に適用する．}
\begin{equation} 
    \begin{cases}
        \begin{split}
        & x'[l]=x[l+1]-x[l] \\
        & x''[l]=x'[l+1]-x'[l]
        \end{split}                         &   \forall{l}
    \end{cases}
\end{equation}

\textcolor{red}{次に，もう一度調波構造を強調する目的で，信号に半波整流を適用する．}
\begin{equation} 
x_{\mathrm{r}}[l] =
    \begin{cases}
        \begin{split}
        & x''[l]\quad \mathrm{if}\quad x''[l]\geqq0 \\
        & 0\hspace{25pt} \mathrm{otherwise}
        \end{split}                         &   \forall{l}
    \end{cases}
\end{equation}
\textcolor{red}{さらに，心拍信号が多く存在する帯域である.7--1.4~Hzを通過域とする5次楕円IIRバンドパスディジタルフィルタを適用する．この処理を次式で表す．}
\begin{align}
    \left(x_{\mathrm{BPF}}[l]\right)_{l=1}^{L}=\mathrm{BPF}\left[\left(x_{\mathrm{r}}\right)_{l=1}^{L}\right]
\end{align} \label{eq:bpf}

\textcolor{red}{最後に}，$\left(x_{\mathrm{BPF}}[l]\right)_{l=1}^{L}$\textcolor{red}{にSTFTを適用してスペクトログラムに変換し，振幅スペクトログラムの最大ピークとなる周波数を時間フレーム毎に求めることで，推定心拍を得る．}

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
\textcolor{red}{本章では，前章で得られた観測信号に対してBSSを適用する動機について述べた．振動測定系と体表面の相対的な位置関係が未知であることと，BSSは音響信号処理分野で高度に発展しているため本研究で用いることは妥当である．また，周波数領域BSSの定式化を行い，その代表的な手法であるIVAについて説明した．行列分解の手法の一つであるISNMFについて説明し，ILRMAの生成モデル及び反復更新式について概説した．で導入された手法について説明した．また，複素Student's $t$分布を生成モデルに持つようなILRMAである$t$-ILRMAについて説明した．振動測定系から得られる観測信号に前述した手法を適用して得られる分離信号に対して適用する心拍推定アルゴリズムについても説明した．次章では予備実験として，\ref{chap:measurementstructsig}章の振動測定系から得られる観測信号に，\ref{sec:conv:iva}節で説明したIVAを適用し，実験結果の解説を行う．}

\chapter{観測信号にフィルタを適用しない場合のBSS及び心拍推定実験}
\label{chap:bsshrexp}

%----------------------------------------------
\section{まえがき}
%------------------------------------------
本章では，\textcolor{red}{\ref{chap:measurementstructsig}章の振動測定系で観測された4チャネルのレーダアレイの}観測信号に対して，\textcolor{red}{\ref{sec:conv:iva}節で述べた}IVAを適用した結果を\textcolor{red}{示し，}心拍推定アルゴリズム\textcolor{red}{の精度向上について実験的に検討する．但し，本節では，レーダセンサから得られる信号に前処理を加えず，そのままIVAを適用した結果を予備実験として示している．より詳細な実験については次章にまとめて示すが，\ref{chap:bsshrexp}章と\ref{chap:fbsshrexp}章の違いは，前処理として観測信号に呼吸による体動に由来するノイズを除去するためのハイパスフィルタの適用の有無である．}
\textcolor{red}{なお，心拍推定の精度を確認するために必要な心拍の参考値（リファレンス）については，\ref{chap:measurementstructsig}章で述べた接触型ECGセンサの観測信号を心拍推定アルゴリズムに適用した推定値を用いている．}心拍推定の比較には，接触型ECGセンサの測定値を用いている．

まず\ref{sec:conv:expcondition4}節では，IVAを適用させる際のパラメタについて述べる．
\ref{sec:conv:expresult4}節では，IVAを適用させて得られたスペクトログラムと心拍推定グラフについての解説を述べる．

%----------------------------------------------
\section{本実験の動機}
\label{sec:conv:expmotivation}
%----------------------------------------------
\textcolor{red}{まず，本章では\ref{chap:measurementstructsig}章で述べた振動測定系から得られる時間波形（背部及び臀部のData no. 0からData no. 6）を使用する．これらの時間波形には呼吸による体動に起因するノイズ及び振動台による振動が含まれている．また，振動測定系の混合系は未知であるため，最適なSTFTの窓長を定めることができない．しかしながら，これまで研究されてきたBSSの傾向としてSTFTの窓長は，分離精度にかなり影響を与えるパラメタであることが分かっている\cite{winlengthBSS}．従って，本実験における最適な窓長を実験的に調査する必要がある．}

\textcolor{red}{本論文で取り扱う観測信号は音響信号ではないが，依然としてSTFTの窓長がBSSの性能に与える影響は大きいと予想される．そのため，本章では予備実験として4パターンのSTFTの窓長を試し，それぞれのBSSの結果及び心拍推定アルゴリズムを適用した結果の精度について調査する．}

%----------------------------------------------
\section{実験条件}
\label{sec:conv:expcondition4}
%----------------------------------------------
\textcolor{red}{前節で述べた通り，STFTの窓長は分離精度にかなり影響を与えるパラメタであることが知られている．そのため，本章の実験では，窓長を32点（0.8~s），64点（1.6~s），96点（2.4~s）, 及び128点（3.2~s）, シフト長をそれぞれ，2点（0.05~s），4点（0.1~s），6点（0.15~s）, 及び8点（0.2~s）に設定したSTFTによって計算される．分離行列$\bm{W}_{i}$の初期値は全ての周波数ビンに対して$N\times N$の単位行列とした．ここで$N$はチャネル数を表す．また，IVAの式（\ref{ep:auxIVAip1}）--（\ref{ep:auxIVAip3}）に示した反復更新式の反復回数は100回に設定した．}

%----------------------------------------------
\section{実験結果}
\label{sec:conv:expresult4}
%----------------------------------------------

\textcolor{red}{本節以降では，\ref{chap:measurementstructsig}章のTable~\ref{tab:vibevacondition}で示した振動条件（Data no.~0からData no.~6）と2種類の測定部位（背部又は臀部）を組み合わせて実験データを参照する．例えば，Data no.~0の背部のレーダセンサから得られる観測信号を「Back no.~0」，Data no.~2の臀部のレーダセンサから得られる観測信号を「Bottom no.~2」等と呼称する．また，本節以降に多くのスペクトログラムを掲載するが，これらの図は窓長を1024点（25.6~s），シフト長を32点（0.8~s）に設定したSTFTで計算されるものに統一されている．周波数領域BSSで処理の対象となる信号（$\bm{X}_m$等）とは，窓長及びシフト長が異なる点に注意する．}

Fig. \ref{fig:siva32obs}は観測信号Back no.~2のスペクトログラムである．\textcolor{red}{Fig.~\ref{fig:ecgspect}に\ref{chap:measurementstructsig}章で述べた接触型ECGセンサから得られる心拍信号のスペクトログラムを示す．従って，BSSで得られた分離信号の中の心拍信号がこのスペクトログラムにどの程度近いかが重要となる．Figs. \ref{fig:siva32est}--\ref{fig:siva128est}は，Back no.~2の観測信号に対して，前節で述べた4種類の窓長及びシフト長でSTFTしIVAを適用することで得られる分離信号のスペクトログラムである．観測信号は4チャネルであるため，BSSによる分離信号も4つ得られるが，理想的にはこの内のいずれかが心拍信号に対応することを想定している．なお，4つ分離信号から心拍信号を選択する方法については今後の課題とし，本論文では取り扱わない．これらの結果を見るとFigs. \ref{fig:siva32est}では，3番目のスペクトログラムに強く心拍の高調波成分が3.5~Hz，5~Hz，及び6~Hz付近に見られる．一方で，0.4~Hz付近に呼吸による体動に起因するノイズが強く残留しており，心拍成分のみを完全に分離できていない．また，振動の高調波成分はほとんど他のスペクトログラムに分離されているが，1.2~Hzの基本周波数成分がよく残留している．1番目, 2番目, 及び4番目のスペクトログラムを見ると，3番目のスペクトログラムでは見られなかった成分が分離されているが，どれも呼吸又は振動台由来のノイズとなっている．Fig.~\ref{fig:siva64est}についても同様のことがいえる．呼吸の成分は4つの分離信号全てに残留してしまうことが多い．依然として3番目のスペクトログラムに心拍由来の調波構造がよく分離されていることが分かる．Figs. \ref{fig:siva96est}及びFigs. \ref{fig:siva128est}についても概ね同様の傾向であるが，Figs. \ref{fig:siva32est}--\ref{fig:siva128est}の3番目のスペクトログラムのみに注目して窓長の違いとして比較してみると，窓長が長くなるほど振動台由来の3.5~Hz付近の3次高調波成分が強く現れてくる．Figs. \ref{fig:siva32est}では，ノイズの高調波成分は当然分離されているが，呼吸成分も同時に僅かに分離されているのに対してFigs. \ref{fig:siva64est}では心拍成分があまり分離されずに残留している．これらより，最もバランスよく心拍成分が分離されている窓長は64点であるといえる．}

\textcolor{red}{次に，窓長を64点に設定したIVAによって分離された観測信号に，心拍推定アルゴリズムを適用した結果をFig.~\ref{fig:hriva}に示す．赤及び青のグラフはそれぞれ，分離信号に心拍推定アルゴリズムを適用したグラフ及び接触型ECGセンサから得られる心拍信号に心拍推定アルゴリズムを適用した推定心拍値（以後，リファレンスデータと呼ぶ）をグラフとして示しており，4つの心拍推定グラフ全てにおいて共通である．Fig.~{fig:hriva}を見ると，1番目及び4番目の心拍推定グラフに振動台由来の振動成分が現れていることが分かる．特に4番目の心拍推定グラフでは振動が加えられている60秒から360秒までの間の振動成分が顕著に表れている．一方で，3番目の心拍推定グラフでは，分離された心拍信号がリファレンスデータを概ね捉えていることが分かる．さらに，心拍数の推定結果の領域においても窓長による違いをFig.~\ref{fig:hrivawinlen}に示す．但し，すべての窓長において分離信号の3番目の信号に心拍推定アルゴリズムを適用した心拍推定グラフを掲載している．4つの心拍推定グラフを比較すると，窓長が96点および128点の心拍推定信号は前述した通り，振動の3次高調波成分現れてくることからリファレンスデータをあまり捉えられていない．窓長が32点及び64点の心拍推定信号はどちらも概ねリファレンスデータを捉えている．この２つの窓長における違いは甲乙つけ難いが，その他のデータ（背部及び臀部の他のData no.~）についても同様の比較を行った結果，窓長が64点の場合安定してリファレンスデータに近い心拍推定値が得られたため，以後の実験ではSTFTの窓長を64点に設定して調査を行う．}


%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_32_obs.pdf}
\caption{Observed signal Back no.~2.}
\label{fig:siva32obs}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=0.7\hsize]{./ch_conventional/fig/ecgspect.pdf}
\caption{Spectrogram obtained by contact ECG sensor.}
\label{fig:ecgspect}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_32_est.pdf}
\caption{Spectrograms of separated signals of Back no.~2, wher window length is set to 32 points.}
\label{fig:siva32est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_64_est.pdf}
\caption{Spectrograms of separated signals of Back no.~2, wher window length is set to 64 points.}
\label{fig:siva64est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_96_est.pdf}
\caption{Spectrograms of separated signals of Back no.~2, wher window length is set to 96 points.}
\label{fig:siva96est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_128_est.pdf}
\caption{Spectrograms of separated signals of Back no.~2, wher window length is set to 128 points.}
\label{fig:siva128est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[htbp]
     \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_64_ch1.pdf}
        \subcaption{First estimated signal}
        \label{fig:hriva32ch1}
      \end{minipage} 
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_64_ch2.pdf}
        \subcaption{Second estimated signal}
        \label{fig:hriva32ch2}
      \end{minipage} \\
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_64_ch3.pdf}
        \subcaption{Third estimated signal}
        \label{fig:hriva32ch3}
      \end{minipage} 
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_64_ch4.pdf}
        \subcaption{Fourth estimated signal}
        \label{fig:hriva32ch4}
      \end{minipage} 
     \caption{Estimated (red) and reference (blue) heart rates of Back no.~2 obtained by IVA for each separated signal.}
     \label{fig:hriva}
  \end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[htbp]
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_32_ch3.pdf}
        \subcaption{Windw length is set to 32}
        \label{fig:hriva32ch3}
      \end{minipage} 
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_64_ch3.pdf}
        \subcaption{Windw length is set to 64}
        \label{fig:hriva64ch3}
      \end{minipage} \\
   
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_96_ch3.pdf}
        \subcaption{Windw length is set to 96}
        \label{fig:hriva96ch3}
      \end{minipage} 
      \begin{minipage}[t]{0.45\hsize}
        \centering
        \includegraphics[keepaspectratio, width=6.5cm]{./ch_conventional/hrfig/hr_iva_128_ch3.pdf}
        \subcaption{Windw length is set to 128}
        \label{fig:hriva128ch3}
      \end{minipage} 
     \caption{Estimated (red) and reference (blue) heart rates of separated heartbeat signals of Back no.~2 obtained by IVA with various window lengths: (a)~32 points, (b)~64 points, (c)~96, (d)~128 points.}
     \label{fig:hrivawinlen}
  \end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
\textcolor{red}{本章では，\ref{chap:measurementstructsig}章で得られた観測信号に対してIVAを適用した．但し，STFTの窓長が分離制度に影響を与えるパラメタであるため，窓長を32点（0.8~s），64点（1.6~s），96点（2.4~s）, 及び128点（3.2~s）, シフト長をそれぞれ，2点（0.05~s），4点（0.1~s），6点（0.15~s）, 及び8点（0.2~s）に設定して最適な窓長の調査を行った．また，接触型ECGセンサから得られる心拍信号のスペクトログラムと比較も行った．さらに，これらの分離信号に心拍推定アルゴリズムを適用し，心拍推定値とリファレンスデータとの比較も行った．これらの実験の結果，STFTの最適な窓長は64点であることを確認した．しかしながら，呼吸による体動に起因するノイズは全ての分離信号に強く残留しているため，完全に心拍信号のみを分離することは困難である．そのため，前処理として観測信号から呼吸を落とすハイパスフィルタを適用してBSSを行う手法について次章で検討する．}


\chapter{観測信号にフィルタを適用した場合のBSS及び心拍推定実験}
\label{chap:fbsshrexp}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
\textcolor{red}{前章の実験結果より，観測信号に含まれる呼吸による体動に起因するノイズ信号（Fig.~\ref{fig:siva32obs}における0.4~Hz付近の成分）が周波数領域BSSではあまり除去できないことが確認された．この呼吸のノイズ信号はあまり明確な調波構造を持っておらず，基本周波数のみが顕著な周波数特性であることがFig.~\ref{fig:siva32obs}から確認される．そこで，本章では，周波数領域BSSをてきようする前の処理として，呼吸のノイズ信号を除去するハイパスフィルタを適用することを提案し，この効果について実験的に調査する．特に本章では，前述の前処理の適用に加えて，IVA，基底数固定型ILRMA, 基底数可変型LRMA, 及び$t$-ILRMAの４手法を適用して比較することにより，どの手法が高精度な心拍推定を実現できるか検討する．
まず\ref{sec:conv:filteroutline}節では，前処理として新たに観測信号の各チャネルに適用するディジタルフィルタの設計仕様について述べる．\ref{sec:conv:expcond5}節では，IVA，基底数固定型ILRMA，基底数可変型ILRMA，$t$-ILRMAの4手法の実験条件について説明する．\ref{sec:conv:expresult5}節では，各項に手法毎の結果をまとめて考察し，本章の結論を\ref{sec:conv:conclusion5}で述べる．}

%----------------------------------------------
\section{\textcolor{red}{前処理として適用するフィルタの設計}}
\label{sec:conv:filteroutline}
%----------------------------------------------
\textcolor{red}{本章の実験で適用するハイパスフィルタの詳細について説明する．観測信号のスペクトログラムであるFig.~\ref{fig:siva32obs}より，呼吸による体動に起因するノイズ信号はおよそ0.4~Hz付近に存在することが確認できる．そこで，本論文では，前処理として，カットオフ周波数を1.5~Hzとするハイパスフィルタを観測信号の各チャネルに対して適用する．このハイパスフィルタは，位相歪みが生じない線形位相特性を満たすようにFIRディジタルフィルタとして設計している．フィルタのタップ長（次数）は170次である．このフィルタの振幅応答と位相応答をFigs.~\ref{fig:ampres}及び\ref{fig:phaseres}にそれぞれ示す．次節では，このハイパスフィルタをチャネル毎に適用した信号を周波数領域BSSの観測信号とみなし，心拍信号の分離を行う．}

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/ampprop.pdf}
\caption{Amplitude response of high-pass digital filter used in preprocessing for observed signals.}
\label{fig:ampres}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[!t]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/phaseprop.pdf}
\caption{Phase response of high-pass digital filter used in preprocessing for observed signals.}
\label{fig:phaseres}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{実験条件}
\label{sec:conv:expcond5}
%----------------------------------------------

\textcolor{red}{前章の実験において，最もバランスよく心拍信号が分離されたSTFTの窓長及びシフト長はそれぞれ，64点（1.6~s）及び4点（0.1~s）であることが分かったため，これらをIVA，ILRMA（基底数固定型と基底数可変型を含む），及び$t$-ILRMAのSTFTの窓長及びシフト長として設定した．IVA，ILRMA，及び$t$-ILRMAのその他の実験条件を以下に示す．}

\textcolor{red}{まず，IVAの実験条件を示す．分離行列$\bm{W}_{i}$の初期値は全ての周波数ビンに対して$N\times N$の単位行列とした．ここで$N$はチャネル数を表す．また，IVAの式（\ref{ep:auxIVAip1}）--（\ref{ep:auxIVAip3}）に示した反復更新式の反復回数は100回に設定した．}

\textcolor{red}{次に，ILRMAの実験条件（基底数固定型と基底数可変型を含む）を示す．\ref{sec:conv:ilrma}節で示した式（\ref{eq:ip1}）--（\ref{eq:ip3}）の反復更新式の反復回数は100回に設定した．また基底数固定型ILRMAの基底数を各チャネル毎に3本とした．基底数可変型ILRMAでは基底数を12本とした．基底数固定型ILRMAは反復毎にプロジェクションバックで正規化を行い，反復毎にプロジェクションバックで正規化を行わない．その他の実験条件はIVAと同様である．}

\textcolor{red}{最後に，$t$-ILRMAの実験条件を示す．複素Studen's~$t$分布の形状パラメタ$\nu$は1, 2, 及び5に設定し，NMFの信号領域を決定するパラメタ$p$は1（振幅ドメイン）及び2（パワードメイン）と設定した．また，\ref{sec:conv:tilrma}節で示した式（\ref{eq:tip1}）--（\ref{eq:tip3}）の反復更新式の反復回数は100回に設定した．その他の実験条件はIVA及びILRMAと同様である．}


%----------------------------------------------
\section{実験結果}
\label{sec:conv:expresult5}
%----------------------------------------------

%----------------------------------------------
\subsection{\textcolor{red}{フィルタを適用した観測信号}}
\label{sec:conv:resultiva}
%----------------------------------------------
\textcolor{red}{Fig. \ref{fig:sfiva64obs}は\ref{sec:conv:filteroutline}節のフィルタを前処理として適用した測定信号である．1.5~Hz以下の信号がフィルタによって落とされているが，依然としてパワーの小さい領域において, 呼吸信号がみられる0.4~Hzの周波数成分及び振動台による振動の信号が卓越して残留している．}

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_filter_64_obs.pdf}
\caption{Spectrograms of output signals obtained by high-pass filter with Back no.~2 inputs.}
\label{fig:sfiva64obs}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\subsection{IVAを適用した結果}
\label{sec:conv:resultiva}
%----------------------------------------------
Fig. \ref{fig:sfiva64est}はFig. \ref{fig:sfiva64obs}にIVAを適用した結果である．
\textcolor{red}{前章のFig. \ref{fig:siva64est}で見られた3.5~Hz付近の振動の3次高調波がほとんど見られず，心拍の高調波が3.5~Hz，5~Hz，及び6~Hz付近に強く現れている．1番目，2番目，及び4番目のスペクトログラムには心拍の高調波成分が見られず，振動及び呼吸の高調波成分が分離されていることが分かる．}

\textcolor{red}{また，Fig. \ref{fig:sfiva64est}に対して心拍推定アルゴリズムを適用した心拍推定値をFig. \ref{fig:fhriva64ch3}はに示す．前章のFig. \ref{fig:hriva64ch3}の150秒から加振終了時（360秒）では捉えられていなかったリファレンスデータを捉えていることが分かる．但し，200秒付近の推定心拍値はリファレンスデータを捉えられていない．この結果より，フィルタリングを行うことで心拍推定精度が向上するといえる．しかし，加振時（60秒から360秒）にリファレンスデータを捉えられていない箇所がまだ多く存在するため，次節以降で，より心拍推定精度が高くなるBSSの手法について調査する．}

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_iva_filter_64_est.pdf}
\caption{Spectrograms of separated signal of Back no. 2 with high-pass filtering obtained by IVA.}
\label{fig:sfiva64est}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=70mm]{./ch_conventional/hrfig/hr_iva_filter_64_ch3.pdf}
  \caption{Third estimated (red) and reference (blue) heart rates of Back no.~2 obtained by IVA with filter.}
  \label{fig:fhriva64ch3}
\end{figure}
%-%-%-%-%-%-%-%-%


%----------------------------------------------
\subsection{基底数固定型ILRMAを適用した結果}
\label{sec:conv:resultilrma1}
%----------------------------------------------
Fig. \ref{fig:silrma1}は基底数固定型ILRMAを適用した推定信号である．\textcolor{red}{Fig. \ref{fig:sfiva64est}では，1番目，2番目，及び4番目に心拍成分以外の成分が分離されていたが，Fig. \ref{fig:silrma1}では，振動成分が1番目及び4番目のスペクトログラムに分離され，2番目のスペクトログラムの4.5~Hz及び5.5~Hz付近に心拍成分がみられる．ここで，Fig. \ref{fig:sfiva64est}及びFig. \ref{fig:silrma1}の3番目のスペクトログラムを比較すると心拍成分のパワーに差がみられないことから，Fig. \ref{fig:sfiva64est}の3番目以外のスペクトログラムにも心拍成分が混在していたと考えられる．}

\textcolor{red}{また，Fig. \ref{fig:silrma1}に対して心拍推定アルゴリズムを適用した心拍推定値をFig. \ref{fig:hrilrma1}に示す．Fig. \label{fig:fhriva64ch3}では60秒から150秒及び360秒から400秒の推定心拍値がリファレンスデータを捉えられていなかったが，基底数固定型ILRMAでは60秒から120秒のみリファレンスデータを捉えられていない．振動が加えられた瞬間は大きく体が動くことが考えらえるため，リファレンスデータを捉えられなかったと考えらる．}

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_ILRMA1_64_est.pdf}
\caption{Spectrograms of separated signal of Back no. 2 with high-pass filtering obtained by ILRMA without partitioning function.}
\label{fig:silrma1}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=70mm]{./ch_conventional/hrfig/hr_ILRMAtype1_64_ch3.pdf}
\caption{Third estimated (red) and reference (blue) heart rates of Back no.~2 obtained by ILRMA without partitioning function.}
\label{fig:hrilrma1}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\subsection{基底数可変型ILRMAを適用した結果}
\label{sec:conv:resultilrma2}
%----------------------------------------------
Fig. \ref{fig:silrma2}は基底数可変型ILRMAを適用した推定信号である．\textcolor{red}{前節でも述べた通り，Fig. \ref{fig:sfiva64est}では，1番目，2番目，及び4番目に心拍成分以外の成分が分離されていたが，Fig. \ref{fig:silrma1}では，振動成分が1番目及び4番目のスペクトログラムに分離され，2番目のスペクトログラムの4.5~Hz及び5.5~Hz付近に心拍成分がみられる．Fig. \ref{fig:silrma2}についても同様の傾向があると言える．Fig. \ref{fig:silrma2}及びFig. \ref{fig:silrma1}のスペクトログラムについては大きな差がみられない．}

\textcolor{red}{また，Fig. \ref{fig:silrma2}に対して心拍推定アルゴリズムを適用した心拍推定値をFig. \ref{fig:hrilrma2}に示す．Fig. \ref{fig:hrilrma1}では，振動が加えられる60秒から120秒までの推定心拍値がリファレンスデータを捉えられていなかったが，Fig. \ref{fig:hrilrma2}では60秒と120秒の一瞬だけリファレンスデータを捉えられていない．しかし，Fig. \ref{fig:hrilrma1}ではとらえられていた振動終了時の360秒においてFig. \ref{fig:hrilrma2}ではリファレンスデータを捉えられていないことが分かる．}

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_ILRMA2_64_est.pdf}
\caption{Spectrograms of separated signal of Back no. 2 with high-pass filtering obtained by ILRMA with partitioning function.}
\label{fig:silrma2}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=70mm]{./ch_conventional/hrfig/hr_ILRMAtype2_64_ch3.pdf}
\caption{Third estimated (red) and reference (blue) heart rates of Back no.~2 obtained by ILRMA with partitioning function.}
\label{fig:hrilrma2}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\subsection{$t$-ILRMAを適用した結果}
\label{sec:conv:resulttilrma}
%----------------------------------------------
\textcolor{red}{Figs. \ref{fig:stilrmaa5}及びは\ref{fig:stilrmap5}はそれぞれ$p=1$, $\nu = 5$及び$p=2$, $\nu = 5$で$t$-ILRMAを適用した推定信号である．前節のFigs. \ref{fig:silrma1}及び\ref{fig:silrma2}の2番目のスペクトログラムの4.5~Hz及び5.5~Hz付近に見られた心拍成分がFigs. \ref{fig:stilrmaa5}及びは\ref{fig:stilrmap5}では見られない．さらに，Figs. \ref{fig:stilrmaa5}及びは\ref{fig:stilrmap5}の3番目のスペクトログラムに見られる心拍成分のパワーがFigs. \ref{fig:sfiva64est}, \ref{fig:silrma1}及び\ref{fig:silrma2}に比べて僅かではあるが強くなっていることが分かる．また，Figs. \ref{fig:sfiva64est}, \ref{fig:silrma1}及び\ref{fig:silrma2}の３番目のスペクトログラムの3.5~Hzに見られた振動の高調波成分がFigs. \ref{fig:stilrmaa5}及びは\ref{fig:stilrmap5}では見られない．}

\textcolor{red}{Figs. \ref{fig:stilrmaa5}及びは\ref{fig:stilrmap5}に対して心拍推定アルゴリズムを適用した心拍推定値をFigs. \ref{fig:hrtilrmaa5}及び\ref{fig:hrtilrmap5}に示す．Figs. \ref{fig:hrtilrmaa5}及び\ref{fig:hrtilrmap5}より，NMFモデルの信号領域の違いによる心拍推定精度の差はほとんどない．Figs. \ref{fig:fhriva64ch3}, \ref{fig:hrilrma1}, 及び\ref{fig:hrilrma2}よりも心拍推定精度が良いことが分かる．振動が加えられた60秒付近でのみリファレンスデータを捉えられていない．これは，振動が加えられた瞬間の体動は大きくなるためであると考えられる．}

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_tILRMA_ampdom_dofp5_64_est.pdf}
\caption{Spectrograms of separated signal of Back no. 2 with high-pass filtering obtained by $t$-ILRMA, where $p=1$ and $\nu=5$.}
\label{fig:stilrmaa5}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=1.0\hsize]{./ch_conventional/fig/spect_tILRMA_powdom_dofp5_64_est.pdf}
\caption{Spectrograms of separated signal of Back no. 2 with high-pass filtering obtained by $t$-ILRMA, where $p=2$ and $\nu=5$.}
\label{fig:stilrmap5}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=70mm]{./ch_conventional/hrfig/hr_tILRMA_ampdom_dofp5_64_ch3.pdf}
\caption{Third estimated (red) and reference (blue) heart rates of Back no.~2 obtained by $t$-ILRMA, where $p=1$ and $\nu=5$.}
\label{fig:hrtilrmaa5}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=70mm]{./ch_conventional/hrfig/hr_tILRMA_powdom_dofp5_64_ch3.pdf}
\caption{Third estimated (red) and reference (blue) heart rates of Back no.~2 obtained by $t$-ILRMA, where $p=2$ and $\nu=5$.}
\label{fig:hrtilrmap5}
\end{figure}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{本章のまとめ}
\label{sec:conv:conclusion5}
%----------------------------------------------
\textcolor{red}{本章では，前章の実験結果より，観測信号に含まれる呼吸による体動に起因するノイズ信号が周波数領域BSSであまり除去されていないことから，このノイズ信号を除去するために，カットオフ周波数を1.5~Hzとする170次FIRディジタルハイパスフィルタを設計し，観測信号に適用した．前処理を適用した観測信号にIVA, ILRMA（基底数固定型及び基底数可変型を含む），及び$t$-ILRMAを適用し，得られたスペクトログラムから実験結果の解説を行った．また，各分離信号に心拍推定アルゴリズムを適用し，リファレンスデータに対してどの程度の心拍推定精度が得られたかを確認した．心拍推定アルゴリズムを適用した結果，$t$=ILRMAが最もリファレンスデータを捉えていた．$t$-ILRMAのNMFモデルの信号領域による違いは見られなかった．}