\chapter{振動測定系と測定信号}
\label{chap:conv}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，本研究で扱う信号の測定条件と得られる信号について説明する．
まず\ref{sec:conv:measurementcondition}節では，本研究で使用する信号の測定条件について説明する．
\ref{sec:conv:signal}節では，\ref{sec:conv:measurementcondition}節で述べた測定条件から得られる信号について説明する

%----------------------------------------------
\section{測定条件}
\label{sec:conv:measurementcondition}
%----------------------------------------------
本研究で使用する信号の測定系はFig\ref{fig:sensorstructure}に示されているとおりである．振動台の上に赤色で示すレーダを取り付けたシートを設置し，被験者が座った状態で計全体を振動させる．レーダはFig\ref{fig:sensorimg}に示されているようなビームフォーミングセンサを使用している．これを，シートの背中と臀部に取り付け測定を行う．測定系による振動はsin波で単軸加振であり，振動状態はFig\ref{fig:sensorimg}に示されているとおりである．その他の測定条件はTable\ref{tab:vibevacondition}に示されているとおりである．

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=0.7\hsize]{./ch_conventional/fig/sensorstructure.pdf}
\caption{Image of shaking table.}
\label{fig:sensorstructure}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{figure}[tb]
\centering
\includegraphics[width=0.7\hsize]{./ch_conventional/fig/sensorimg.pdf}
\caption{Image of shking table.}
\label{fig:sensorimg}
\end{figure}
%-%-%-%-%-%-%-%-%

%-%-%-%-%-%-%-%-%
\begin{table}[b]
  \caption{VIbration evaluation conditions}
  \centering
  \scalebox{0.8}[0.9]{
  \begin{tabular}{|c|c|c|c|c|c|c|} \hline
    Data number & subject & Vibration direction & amplitude & Frequency &  Use of handles, etc. & part \\ \hline \hline
    0 & \multirow{7}{*}{G} & - & - & - & - & \multirow{7}{*}{Back and Bottom}   \\ \cline{1-1} \cline{3-3} \cline{4-4} \cline{5-5} \cline{6-6}
    1 & & \multirow{6}{*}{Up and Down} & 4 & 1.2 & - &  \\ \cline{1-1} \cline{4-4} \cline{5-5} \cline{6-6}
    2 & &  & 10 & 1.2 & - &   \\ \cline{1-1} \cline{4-4} \cline{5-5} \cline{6-6}
    3 & &  & 40 & 1.2 & - &   \\ \cline{1-1} \cline{4-4} \cline{5-5} \cline{6-6}
    4 & &  & 40 & 1.2 & Use &   \\ \cline{1-1} \cline{4-4} \cline{5-5} \cline{6-6}
    5 & &  & 4 & 2.4 & - &   \\ \cline{1-1} \cline{4-4} \cline{5-5} \cline{6-6}
    6 & &  & 10 & 2.4 & - &   \\ \hline
  \end{tabular}
  }
  \label{tab:vibevacondition}
\end{table}
%-%-%-%-%-%-%-%-%

%----------------------------------------------
\section{測定で得られる信号}
\label{sec:conv:signal}
%----------------------------------------------

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
本章では，何らか法の従来手法について説明した．
次章以降では，より詳細な何とかや何らか法の適用範囲の拡大を達成するために，
\ref{sec:conv:somewhat:derivation}節で導入した何とか法の発展的な理論拡張を提案する．


\chapter{適用手法}
\label{chap:conv}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，本研究で適用した手法について説明する．
まず\ref{sec:conv:researchmotivation}節では，本研究の動機について説明する．
\ref{sec:conv:bssformularization}節では，周波数領域におけるBSSの定式化を行う．
\ref{sec:conv:isnmf}節では，行列分解の手法の一つであるNMFのうちItakura-Saitoダイバージェンスに基づくNMFについて説明する
\ref{sec:conv:ilrma}節では，本研究で扱ったILRMA，\ref{sec:conv:tilrma}節では，本研究で扱った$t$-ILRMAについて，\ref{sec:conv:heartrateestalgo}節では，心拍推定アルゴリズムについて説明する．

%----------------------------------------------
\section{本研究の動機}
\label{sec:conv:researchmotivation}
%----------------------------------------------

%----------------------------------------------
\section{BSSの定式化}
\label{sec:conv:bssformularization}
%----------------------------------------------

周波数領域のBSSの定式化を行う．
複数の音源が混合している観測信号中の音源数及びチャネル数をそれぞれ$N$及び$M$と定義する．
Fig. \ref{fig:bss}に$N=M=2$の場合のBSSの概略を示す．
混合前の音源，観測信号及び分離信号に対して短時間フーリエ変換(short time fourier transformation: STFT)したものをそれぞれ
\begin{align}
\bm{s}_{ij} &= (s_{ij,1}, s_{ij,2}, \cdots, s_{ij,n}, \cdots, s_{ij,N})^{\mathrm{T}} \in \mathbb{C}^{N} \label{eq:s} \\
\bm{x}_{ij} &= (x_{ij,1}, x_{ij,2}, \cdots, x_{ij,m}, \cdots, x_{ij,M})^{\mathrm{T}} \in \mathbb{C}^{M} \label{eq:x} \\
\bm{y}_{ij} &= (y_{ij,1}, y_{ij,2}, \cdots, y_{ij,n}, \cdots, y_{ij,N})^{\mathrm{T}} \in \mathbb{C}^{N} \label{eq:y}
\end{align}
と定義する．
ここで，$n=1, 2,  \cdots, N$及び$m=1, 2, \cdots, M$はそれぞれ音源及びチャネルのインデクスを表す．
式(\ref{eq:s})から式(\ref{eq:y})と周波数ごとの時不変な（時間フレーム$j$に依存しない）混合行列$\bm{A}_i \in \mathbb{C}^{M\times N}$を用いると，混合時の残響長がSTFTの短時間信号長（窓長）$L$よりも十分に短い場合，観測信号は次式で表せる.
\begin{align}
  \bm{x}_{ij} = \bm{A}_i \bm{s}_{ij} \label{eq:xas}
\end{align}
ここで，$M=N$かつ$\bm{A}_i$がフルランクの場合は，分離行列$\bm{W}_{i} = (\bm{w}_{i1}~\bm{w}_{i2}~\cdots~ ~\bm{w}_{iN})^{\mathrm{H}} \in \mathbb{C}^{N \times M} $が存在し，分離信号は次式で表せる．
\begin{align}
  \bm{y}_{ij} = \bm{W}_i \bm{x}_{ij} \label{eq:ywj}
\end{align}
ここで，$^{\mathrm{H}}$は行列またはベクトルのエルミート転置を表す．
BSSは混合行列$\bm{A}_i$が未知の状態で分離行列$\bm{W}_{i}$を全ての周波数$i=1, 2, \cdots, I$において推定する問題である．

パーミュテーション問題は様々な解決法が提案されており，後述のILRMAはパーミュテーション問題を回避する手法である．


%----------------------------------------------
\section{Itakura-Saito ダイバージェンスに基づくNMF}
\label{sec:conv:isnmf}
%----------------------------------------------

NMF~\cite{NMF}とは行列分解の方法の一つである．
NMFが他の行列分解の方法であるLU分解や固有値分解と異なるのは非負値行列を対象としている点である．
また，NMFは対象とする非負値行列の低ランク性を仮定して分解することで，行列の潜在パタンを抽出できるアルゴリズムである．
そして，NMFは劣決定音源分離に適用することが可能である\cite{singlechsep, supNMF, MNMF_oz}．
単一チャネルの音響信号をSTFTすることで得られるパワースペクトログラムのNMFによる分解は次式で表される．

\begin{align}
    |\bm{Z}|^{.2} = \bm{TV}
\end{align}
ここで，$| \cdot |$は要素ごとの絶対値を，ドット付きの指数は要素ごとの累乗を示す．よって，$|\bm{Z}|^{.2}$はパワースペクトログラムを表す．
また，$\bm{T} \in \mathbb{R}^{I \times K}_{\geq 0}$を基底行列，$\bm{V} \in \mathbb{R}^{K \times J}_{\geq 0}$をアクティベーション行列という．
$K$はNMFの分解において手動で与えるパラメタであり，基底行列$\bm{T}$の列ベクトルの本数（基底ベクトル数）である．従って，行列積$\bm{TV}$のランクは$K$と一致し，通常は$K \ll \min (I,J)$となるように設定される．
つまり，Fig. \ref{fig:nmf_ps}に示すように単一チャネルの音響信号を対象としたNMFでは，パワースペクトログラムに対して低ランク近似を行うことで，$\bm{T}$が音響信号中の頻出スペクトルパタンとなり，$\bm{V}$が各スペクトルパタンの発音タイミング（アクティベーション）となるような分解が可能である．
また，基底行列$\bm{T}$とアクティベーション行列$\bm{V}$は次式の最小化問題の解として推定される．

\begin{align}
    \nonumber \min_{\bm{T,V}} \mathcal{D}(|\bm{Z}|^{.2} | \bm{TV}) ~~ & \mathrm{s.t.} ~ t_{ik}, v_{kj} \geq 0 \\ &\forall i = 1, 2, ..., I, ~j = 1, 2, ..., J, ~k = 1, 2, ..., K 
\end{align}
ここで，$t_{ik}$及び$v_{kj}$は$\bm{T}$及び$\bm{V}$の要素である．
また，$ \mathcal{D}(|\bm{Z}|^{.2} | \bm{TV})$は2つの行列（$|\bm{Z}|^{.2}$及び$\bm{TV}$）間の類似度を測る関数である．
行列の類似度を図る関数には，次式で表される$\beta$-divergence~\cite{psi-div, ext_nmf}がよく利用される\cite{pssnmf}．
\begin{align}
  d_{\beta}(a|b) = \left\{ \begin{array}{lll}
    \displaystyle \frac{a}{b} - \log \frac{a}{b} -1 & (\beta = 0) \\
    a \log \displaystyle\frac{a}{b} + b - a & (\beta =1) \\
    \displaystyle \frac{a^{\beta}}{\beta (\beta -1)} + \frac{b^{\beta}}{\beta} - \frac{ab^{\beta - 1}} {\beta - 1} & (\mathrm{otherwise}) 
  \end{array} \right. \label{eq:betad}
\end{align}
$\beta$-divergenceの中でも特に$\beta= 2,1,0$の場合はそれぞれ二乗Euclid距離，一般化Kullback--Leiblerダイバージェンス及びItakura--Saitoダイバージェンスと呼ばれている．
これらのうち，ダイバージェンスと名のつくものは以下に示す距離の公理
\begin{enumerate}
  \item 非負性：$\mathcal{D}(a|b) \geq 0 ~~\forall a,b \in \mathbb{R}$
  \item 同一性：$\mathcal{D}(a|b) = 0 \Leftrightarrow a = b~~\forall a,b \in \mathbb{R}$
  \item 対称性：$\mathcal{D}(a|b)= \mathcal{D}(a|b) ~~\forall a,b \in \mathbb{R}$
  \item 三角不等式：$\mathcal{D}(a|b) + \mathcal{D}(b|c) \geq \mathcal{D}(a|c) ~~\forall a,b,c \in \mathbb{R}$
\end{enumerate}
のうち，対称性と三角不等式を満たさない．

本論文ではItakura--Saitoダイバージェンスに基づくNMF（Itakura--Saito-divergence-based NMF: ISNMF）\cite{isnmf}について述べる．
$\bm{Z}$の要素である複素スペクトル$z_{ij}$が以下の確率モデルに従って生成されていると仮定する．
\begin{align}
    z_{ij} = \sum_k c_{ij,k} \\
    c_{ij,k} \sim \mathcal{N}_{\mathbb{C}} (0, t_{ik}v_{lj})
\end{align}
ここで，$c_{ij,k} \in \mathbb{C}$は全ての$i$，$j$及び$k$に関して互いに独立と仮定する．
また，$c$を複素数の確率変数としたとき，$\mathcal{N}_{\mathbb{C}} (\mu, \sigma^2)$は一次元複素ガウス分布を表し，その確率密度関数は次式で与えられる．
\begin{align}
    p_c(c | \mu, \sigma^2) &= \frac{1}{\pi \sigma^2} \exp \left\{ -\frac{|c-\mu|^2}{\sigma^2} \right\}
\end{align}
ここで，$\mu$及び$\sigma^2$はそれぞれ平均及び分散を示す．
また，$c_1$と$c_2$が独立である場合，ゼロ平均の一次元複素ガウス分布において以下の加法性が成り立つ．
\begin{align}
    c_1 \sim \mathcal{N}_{\mathbb{C}}(0,\sigma_1^2)かつc_2 \sim \mathcal{N}_{\mathbb{C}}(0,\sigma_2^2) ~~ \Longrightarrow ~~ c_1 + c_2 \sim \mathcal{N}_{\mathbb{C}}(0,\sigma_1^2 + \sigma_2^2)
\end{align}
よって，
\begin{align}
    \sum_k c_{ij,k} \sim \mathcal{N}_{\mathbb{C}}\left( 0, \sum_k t_{ik} v_{kj} \right)
\end{align}
を用いて次式が成り立つ．
\begin{align}
    z_{ij} \sim \mathcal{N}_{\mathbb{C}}\left( 0, \sum_k t_{ik} v_{kj} \right) \label{eq:nmfgen}
\end{align}
これがISNMFの生成モデルで，Fig. \ref{fig:gauss}のような球対称複素ガウス分布である．
ここで，観測信号$z_{ij}$が与えられた場合における$t_{ik}$及び$v_{kj}$の最尤推定問題を考える．
このとき，尤度関数は
\begin{align}
    \mathcal{L}(\bm{T}, \bm{V}) = \prod_{i,j} \frac{1}{\pi \sum_k t_{ik} v_{kj} } \exp \left( -\frac{|z_{ij}|^2}{\sum_k t_{ik} v_{kj}} \right)
\end{align}
となり，負対数尤度は
\begin{align}
    -\log\mathcal{L}(\bm{T}, \bm{V}) = \sum_{i,j} \left( \frac{|z_{ij}|^2}{\sum_k t_{ik} v_{kj}} + \log \sum_k t_{ik} v_{kj} + \log \pi \right)
\end{align}
で表される．
これは観測信号のパワースペクトログラム$|z_{ij}|^2$に対するISNMFの目的関数(式（\ref{eq:betad})の$\beta = 0$の場合）と定数部分を除いて一致するので，尤度関数は以下のように書き換えられる．
\begin{align}
    -\log\mathcal{L}(\bm{T}, \bm{V}) = d_{\mathrm{IS}} \left( |z_{ij}|^2 | \sum_k t_{ik} v_{kj} \right) + \mathrm{const.}
    \label{eq:isnmf}
\end{align}
ここで，$d_{\mathrm{IS}}( \cdot | \cdot )$は2つの行列間のItakura-Saitoダイバージェンスを示す．
つまり，ISNMFを観測信号のパワースペクトログラム$|\bm{Z}|^{.2}$に適用したとき，複素スペクトル$z_{ij}$が式(\ref{eq:nmfgen})で表される生成モデルに従い，全時間周波数グリッドに関して互いに独立であると仮定されている．
また，ISNMFの$\bm{T}$及び$\bm{V}$の最適化のための反復更新式は式(\ref{eq:MUT})及び式(\ref{eq:MUV})で表される\cite{MU}．

\begin{align}
    t_{ik} \leftarrow t_{ik} \sqrt \frac{ \sum_j |z_{ij}|^2 v_{kj} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-2} }{ \sum_j v_{kj} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-1} } \label{eq:MUT} \\
    v_{kj} \leftarrow v_{kj} \sqrt \frac{ \sum_i |z_{ij}|^2 t_{ik} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-2} }{ \sum_i t_{ik} \left( \sum_{k'} t_{ik'} v_{k'j} \right)^{-1} } \label{eq:MUV}
\end{align}
この更新式は乗算型反復更新式と呼ばれ，目的関数が単調非増加であることが保証されている．

%----------------------------------------------
\section{ILRMA}
\label{sec:conv:ilrma}
%----------------------------------------------

ILRMAの反復最適化の概要をFig. \ref{fig:ilrma_outline}に示す．
ここで$\bm{T}_n$及び$\bm{V}_n$は$n$番目の音源のパワースペクトログラムをモデル化する基底行列及びアクティベーション行列を示す．
ILRMAはIVAに対応する分離行列$\bm{W}_i$の反復最適化とISNMFの低ランクモデリングに対応する$\bm{T}_n\bm{V}_n$の反復最適化が交互に行われる．
具体的には，分離行列$\bm{W}_i$により推定された分離信号をNMFによって非負低ランク行列でモデル化し，得られた$\bm{T}_n$及び$\bm{V}_n$の各時間周波数成分を式(\ref{eq:nmfgen})における分散（各音源の生成モデルの推定パラメタ）として用いて分離行列を再度推定する，というプロセスが反復的に行われる．
ILRMAの生成モデルはISNMFと同様に次式の複素ガウス分布で表される．
\begin{align}
    y_{ij,n} &= \sum_k c_{ij,k,n} \\
    c_{ij,k,n} &= \mathcal{N}_{\mathbb{C}}(0, t_{ik,n} v_{kj,n}) \label{eq:ilrma_gen}
\end{align}
ここで，$t_{ik,n}$及び$v_{kj,n}$は$n$番目の音源に関する基底行列$\bm{T}_n$及びアクティベーション行列$\bm{V}_n$の非負要素であり，$k = 1, 2, \cdots, K$は基底インデクスである．
また，$c_{ij,k,n} \in \mathbb{C}$は互いに独立であると仮定する．
このとき，観測$x_{ij,n}$が与えられた場合において$\bm{W}_i$，$\bm{T}_n$及び$\bm{V}_n$を最尤推定する問題を考える．
ISNMFのときと同様に
\begin{align}
    \sum_k c_{ij,k,n} \sim \mathcal{N}_{\mathbb{C}}\left( 0, \sum_k t_{ik,n} v_{kj,n} \right)
\end{align}
より，
\begin{align}
    y_{ij,n} \sim \mathcal{N}_{\mathbb{C}}\left( 0, \sum_k t_{ik,n} v_{kj,n} \right) 
\end{align}
が成り立つので，この生成モデルに基づく観測信号の負対数尤度は次式で表される．
\begin{align}
    \mathcal{L}(\mathsf{W, T, V}) = -2J \sum_i \log | \det \bm{W}_i | + \sum_{i,j,n} \left( \frac{|\bm{w}_{i,n}^{\mathrm{H}}\bm{x}_{ij}|^2}{\sum_k t_{ik,n}v_{kj,n}} + \log \sum_k t_{ik,n}v_{kj,n} \right)
    \label{eq:ilrmalike2}
\end{align}
ここで，$\mathsf{W}=\{ \bm{W}_i \}_{i=1}^I$，$\mathsf{T}=\{ \bm{T}_n \}_{n=1}^N$及び$\mathsf{V}=\{ \bm{V}_n \}_{n=1}^N$は最適化パラメタの集合である．
式(\ref{eq:ilrmalike2})を見ると，第二項と第三項は式(\ref{eq:isnmf})のISNMFの尤度関数に対応していることがわかる．

分離行列$\bm{W}_i$の関する最適化は，分離ベクトル$\bm{w}_{i,n}$の更新を反復射影法（iterative projection: IP）\cite{auxIVA}を用いることで次式で行われる．
\begin{align}
\bm{U}_{i,n} &= \frac{1}{J} \sum_j \frac{1}{\sum_{l}t_{ik,n}v_{kj,n}} \bm{x}_{ij} \bm{x}_{ij}^{\mathrm{H}} \label{eq:ip1} \\
\bm{w}_{i,n} &\leftarrow (\bm{W}_i \bm{U}_{i,n})^{-1} \bm{e}_n \label{eq:ip2} \\
\bm{w}_{i,n} &\leftarrow \bm{w}_{i,n} ( \bm{w}_{i,n}^{\mathrm{H}} \bm{U}_{i,n} \bm{w}_{i,n} )^{-\frac{1}{2}} \label{eq:ip3}
\end{align}
ここで，$\bm{e}_n \in \mathbb{R}_{\{0, 1\}}^{N}$は$n$番目の要素が1，他要素が0のベクトルである．

NMFによる低ランクモデリングのパラメタ$\bm{T}_n\bm{V}_n$の最適化は式(\ref{eq:MUT})及び式(\ref{eq:MUV})の乗算型反復更新式を用いて次式で表される．
\begin{align}
t_{ik, n} &\leftarrow  t_{ik, n} \sqrt{ \frac{ \sum_{j} | \bm{w}_{i,n}^{\mathrm{H}}\bm{x}_{ij} |^2 v_{kj, n} ( \sum_{k'} t_{ik', n} v_{k'j, n} )^{-2} }{ \sum_{j} v_{kj, n} ( \sum_{k'} t_{ik', n} v_{k'j, n} )^{-1} } } \label{eq:t} \\
v_{kj, n} &\leftarrow  v_{kj, n} \sqrt{ \frac{ \sum_{i} | \bm{w}_{i,n}^{\mathrm{H}}\bm{x}_{ij} |^2 t_{ik, n} ( \sum_{k'} t_{ik', n} v_{k'j, n} )^{-2} }{ \sum_{i} t_{ik, n} ( \sum_{k'} t_{ik', n} v_{k'j, n} )^{-1} } } \label{eq:v}
\end{align}
これらの更新式も式(\ref{eq:MUT})及び式(\ref{eq:MUV})と同様に目的関数式(\ref{eq:ilrmalike2})の値が単調非増加であることが保証されている．

%----------------------------------------------
\section{$t$-ILRMA}
\label{sec:conv:tilrma}
%----------------------------------------------

Yoshii et al. が提案した$t$-NMFがISNMFやCauchy NMFと比較して性能が向上したことに鑑み，複素Student's$t$分布を生成モデルに持つようなILRMAである$t$-ILRMAが提案された．複素Student's$t$分布二は形状パラメータ$\nu(\textgreater0)$があり，これを$\nu=1$とすると複素Cauchy分布のような安定性は何ため，スペクトログラムの加法の正当性が保証されない．しかし，$\nu=2$付近のときの$t$-NMFは，ISNMFやCaunchy NMFに比べて優れたロバストな結果を示すことが報告されている．$t$-ILRMAの生成モデルは次式で表される．
\begin{align}
     \prod_{i,j}p\left(y_{ij}\right)= \prod_{i,j} \frac{1}{\pi \sigma_{ij}^{2} } \left( 1+\frac{2}{\nu}\frac{|z_{ij}|^2}{\sigma_{ij}^{2}} \right)^{\frac{2+\nu}{2}}　\label{eq:tmodel}
\end{align}
\begin{align}
     \sigma_{ij}^{p}=\sum_{l}t_{il}v_{lk}{eq:tsigma}
\end{align}

ここで，$\sigma_{ij}$は時間周波数ごとに時変な非負値であり，振幅スペクトラム$|z_{ij}|$に関係する量である．$p$はNMFモデルのドメインを決定する量であり，$1\leqq p \leqq$を満たしているとする，$p=1$のときは振幅ドメインのNMFモデルを，$p=2$のときはパワードメインのモデルを考えることに相当する．$p=2$，$\nu\rightarrow\infty$のときはISNMFのモデルに一致し，$p=1$，$\nu=1$のときはCauchyNMFのモデルに一致する，この負の対数尤度をとることにより，$t$-ILRMAのコスト関数
\begin{align}
    \mathcal{L}_{t} = \mathrm{const.}-2J\log|\mathrm{det}\bm{W}_{i}|+\sum_{i,j}\left\lbrack\left(1+\frac{\nu}{2}\right)\log\left(1+\frac{2}{\nu}\frac{|y_{ij}^{2}}{\sigma_{ij}^{2}}\right)+2\log\sigma_{ij}\right\rbrack{eq:tcost}
\end{align}
を得る．

分離行列$\bm{W}_{i}$は節\ref{sec:conv:ilrma}と同様に分離ベクトル$w_{i,n}$の更新をIPを用いることで次式で行われる．
\begin{align}
    U_{i,n}=\frac{1}{J}\left(\frac{2}{\nu}+1\right)\sum_{j}\frac{1}{\alpha_{ij,n}\sigma_{ij,n}^{2}}x_{ij}x_{ij}^{\mathrm{H}} \label{eq:tip1}
\end{align}
\begin{align}
    w_{i,n}\leftarrow\left(W_{i}U_{i,n}\right)^{-1}e_{n} \label{eq:tip2}
\end{align}
\begin{align}
    w_{i,n}\leftarrow\frac{w_{i,n}}{\sqrt{w_{i,n}^{\mathrm{H}}U_{i,n}w_{i,n}}} \label{eq:tip3}
\end{align}

%----------------------------------------------
\section{心拍推定アルゴリズム}
\label{sec:conv:heartrateestalgo}
%----------------------------------------------

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
本章では，何らか法の従来手法について説明した．
次章以降では，より詳細な何とかや何らか法の適用範囲の拡大を達成するために，
\ref{sec:conv:somewhat:derivation}節で導入した何とか法の発展的な理論拡張を提案する．


\chapter{観測信号にフィルタを適用しない場合のBSS及び心拍推定実験}
\label{chap:conv}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，何らか法の従来手法を説明する．
まず\ref{sec:conv:something}節では，何らかの分野で従来より用いられる何とかについて何とかを導入する．
\ref{sec:conv:somewhat}節では，なんとかについて述べる．

%----------------------------------------------
\section{実験条件}
\label{sec:conv:something}
%----------------------------------------------

%----------------------------------------------
\section{実験結果}
\label{sec:conv:somewhat}
%----------------------------------------------

%----------------------------------------------
\subsection{基底数固定型ILRMAを適用した結果}
\label{sec:conv:somewhat}
%----------------------------------------------

%----------------------------------------------
\subsection{基底数可変型LRMAを適用した結果}
\label{sec:conv:somewhat}
%----------------------------------------------

%----------------------------------------------
\subsection{$t$-ILRMAを適用した結果}
\label{sec:conv:somewhat}
%----------------------------------------------

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
本章では，何らか法の従来手法について説明した．
次章以降では，より詳細な何とかや何らか法の適用範囲の拡大を達成するために，
\ref{sec:conv:somewhat:derivation}節で導入した何とか法の発展的な理論拡張を提案する．


\chapter{観測信号にフィルタを適用した場合のBSS及び心拍推定実験}
\label{chap:conv}

%----------------------------------------------
\section{まえがき}
%----------------------------------------------
本章では，何らか法の従来手法を説明する．
まず\ref{sec:conv:something}節では，何らかの分野で従来より用いられる何とかについて何とかを導入する．
\ref{sec:conv:somewhat}節では，なんとかについて述べる．

%----------------------------------------------
\section{動機}
\label{sec:conv:something}
%----------------------------------------------

%----------------------------------------------
\section{設計したフィルタ}
\label{sec:conv:something}
%----------------------------------------------

%----------------------------------------------
\section{実験結果}
\label{sec:conv:somewhat}
%----------------------------------------------

%----------------------------------------------
\subsection{基底数固定型ILRMAを適用した結果}
\label{sec:conv:somewhat}
%----------------------------------------------

%----------------------------------------------
\subsection{基底数可変型LRMAを適用した結果}
\label{sec:conv:somewhat}
%----------------------------------------------

%----------------------------------------------
\subsection{$t$-ILRMAを適用した結果}
\label{sec:conv:somewhat}
%----------------------------------------------

%----------------------------------------------
\section{本章のまとめ}
%----------------------------------------------
本章では，何らか法の従来手法について説明した．
次章以降では，より詳細な何とかや何らか法の適用範囲の拡大を達成するために，
\ref{sec:conv:somewhat:derivation}節で導入した何とか法の発展的な理論拡張を提案する．
